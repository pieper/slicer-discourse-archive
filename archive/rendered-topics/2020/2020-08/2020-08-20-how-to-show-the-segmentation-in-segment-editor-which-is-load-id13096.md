# How to show the segmentation in segment editor which is loaded from a nii.gz file generated by other program?

**Topic ID**: 13096
**Date**: 2020-08-20
**URL**: https://discourse.slicer.org/t/how-to-show-the-segmentation-in-segment-editor-which-is-loaded-from-a-nii-gz-file-generated-by-other-program/13096

---

## Post #1 by @SummerZ2020 (2020-08-20 03:39 UTC)

<p>hello all,<br>
I generated a segmented mark file from other program, and saved it to a nii.gz file which can be viewed in ITK snap. And the value is only 0 and 1 in the nii.gz file. Currently I would like use slicer to edit the segmentation result again. So I load the DICOM volume data first, and load the nii.gz file in “Data” module, choosed the label map as shown in picture 1 below.<br>
<div class="lightbox-wrapper"><a class="lightbox" href="https://us1.discourse-cdn.com/flex002/uploads/slicer/original/3X/d/1/d1afb621ea8b7a6a0eadb43fa86f62e288fd2c9f.png" data-download-href="/uploads/short-url/tUYfAiTB74RhDw96lfcnCXEogVN.png?dl=1" title="load" rel="noopener nofollow ugc"><img src="https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/d/1/d1afb621ea8b7a6a0eadb43fa86f62e288fd2c9f_2_690x158.png" alt="load" data-base62-sha1="tUYfAiTB74RhDw96lfcnCXEogVN" width="690" height="158" srcset="https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/d/1/d1afb621ea8b7a6a0eadb43fa86f62e288fd2c9f_2_690x158.png, https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/d/1/d1afb621ea8b7a6a0eadb43fa86f62e288fd2c9f_2_1035x237.png 1.5x, https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/d/1/d1afb621ea8b7a6a0eadb43fa86f62e288fd2c9f_2_1380x316.png 2x" data-dominant-color="F8F8F8"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">load</span><span class="informations">1487×342 12.9 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div><br>
But there is not segmentation in the segment editor, shown in picture 2 below.<br>
<div class="lightbox-wrapper"><a class="lightbox" href="https://us1.discourse-cdn.com/flex002/uploads/slicer/original/3X/0/2/02ed301c9ec7bdad397abdf519d88e887007f440.png" data-download-href="/uploads/short-url/pT7V4N29Fc1phLHp1Y2UbLLrIk.png?dl=1" title="seg" rel="noopener nofollow ugc"><img src="https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/0/2/02ed301c9ec7bdad397abdf519d88e887007f440_2_690x417.png" alt="seg" data-base62-sha1="pT7V4N29Fc1phLHp1Y2UbLLrIk" width="690" height="417" srcset="https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/0/2/02ed301c9ec7bdad397abdf519d88e887007f440_2_690x417.png, https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/0/2/02ed301c9ec7bdad397abdf519d88e887007f440_2_1035x625.png 1.5x, https://us1.discourse-cdn.com/flex002/uploads/slicer/original/3X/0/2/02ed301c9ec7bdad397abdf519d88e887007f440.png 2x" data-dominant-color="F7F7F7"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">seg</span><span class="informations">1260×763 39.6 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div><br>
And then switch to the Segmentation module, choose the right input node in the “exprots/imports models and labelmaps” and click import(shown in pic3), and then there is the segmentation in the segment editor.<br>
<div class="lightbox-wrapper"><a class="lightbox" href="https://us1.discourse-cdn.com/flex002/uploads/slicer/original/3X/e/e/eeee327633f4d4a0113afbdbc71f0d15327dbcf2.png" data-download-href="/uploads/short-url/y5FYjXxQqYozsxUMNj5gYtsNaBY.png?dl=1" title="import" rel="noopener nofollow ugc"><img src="https://us1.discourse-cdn.com/flex002/uploads/slicer/original/3X/e/e/eeee327633f4d4a0113afbdbc71f0d15327dbcf2.png" alt="import" data-base62-sha1="y5FYjXxQqYozsxUMNj5gYtsNaBY" width="690" height="176" data-dominant-color="F6F6F6"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">import</span><span class="informations">1229×315 11.7 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div><br>
but only the original dicom is shown in the editor, there is not any mark , shown in pic 4 below.<br>
<div class="lightbox-wrapper"><a class="lightbox" href="https://us1.discourse-cdn.com/flex002/uploads/slicer/original/3X/0/0/000dceff74042646ca1458ed0b568c2653881f59.jpeg" data-download-href="/uploads/short-url/tAfO9zOsXsVn9XesUA8RZKauJ.jpeg?dl=1" title="Capture" rel="noopener nofollow ugc"><img src="https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/0/0/000dceff74042646ca1458ed0b568c2653881f59_2_690x371.jpeg" alt="Capture" data-base62-sha1="tAfO9zOsXsVn9XesUA8RZKauJ" width="690" height="371" srcset="https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/0/0/000dceff74042646ca1458ed0b568c2653881f59_2_690x371.jpeg, https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/0/0/000dceff74042646ca1458ed0b568c2653881f59_2_1035x556.jpeg 1.5x, https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/0/0/000dceff74042646ca1458ed0b568c2653881f59_2_1380x742.jpeg 2x" data-dominant-color="949495"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">Capture</span><span class="informations">2556×1375 340 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div><br>
So how to show the mark in the nii.gz file which load just now? thanks in advance.</p>

---

## Post #2 by @SummerZ2020 (2020-08-21 01:22 UTC)

<p>Does anyone can help? Thank you so much.</p>

---

## Post #3 by @muratmaga (2020-08-21 02:06 UTC)

<p>I would load the labelmap (nii.gz) file and DICOM individually into Slicer scene, and make sure that they indeed occupy the same space. It is possible that something went wrong during the export process (or it was lossy). If the labelmap shows up in correct place, then you can go back and load the labelmap, but instead of volume type, choose segmentation.</p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="https://us1.discourse-cdn.com/flex002/uploads/slicer/original/3X/4/0/40c48e5d83771df18f699360ae3c9e7251f24f1f.png" data-download-href="/uploads/short-url/9eXG0QYWC125LkukBCloPKjOklp.png?dl=1" title="image"><img src="https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/4/0/40c48e5d83771df18f699360ae3c9e7251f24f1f_2_690x135.png" alt="image" data-base62-sha1="9eXG0QYWC125LkukBCloPKjOklp" width="690" height="135" srcset="https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/4/0/40c48e5d83771df18f699360ae3c9e7251f24f1f_2_690x135.png, https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/4/0/40c48e5d83771df18f699360ae3c9e7251f24f1f_2_1035x202.png 1.5x, https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/4/0/40c48e5d83771df18f699360ae3c9e7251f24f1f_2_1380x270.png 2x" data-dominant-color="DEEAEC"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">image</span><span class="informations">1665×328 21.2 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>

---

## Post #4 by @SummerZ2020 (2020-08-21 02:34 UTC)

<aside class="quote no-group" data-username="muratmaga" data-post="3" data-topic="13096">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="24" height="24" src="https://sea2.discourse-cdn.com/flex020/user_avatar/discourse.slicer.org/muratmaga/48/3622_2.png" class="avatar"> muratmaga:</div>
<blockquote>
<p>and make sure that they indeed occupy the same space.</p>
</blockquote>
</aside>
<p>Thank your so much for detailed answer. I choose segmentation when load the nii.gz file now. The screenshot is shown in the picture below.<br>
<div class="lightbox-wrapper"><a class="lightbox" href="https://us1.discourse-cdn.com/flex002/uploads/slicer/original/3X/1/3/131e7e1cf9f0eac1e7fb71251cb2d0fbe48cbfed.png" data-download-href="/uploads/short-url/2J8oVENcZZf8Jala36wji9OyF9H.png?dl=1" title="Capture" rel="noopener nofollow ugc"><img src="https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/1/3/131e7e1cf9f0eac1e7fb71251cb2d0fbe48cbfed_2_690x118.png" alt="Capture" data-base62-sha1="2J8oVENcZZf8Jala36wji9OyF9H" width="690" height="118" srcset="https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/1/3/131e7e1cf9f0eac1e7fb71251cb2d0fbe48cbfed_2_690x118.png, https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/1/3/131e7e1cf9f0eac1e7fb71251cb2d0fbe48cbfed_2_1035x177.png 1.5x, https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/1/3/131e7e1cf9f0eac1e7fb71251cb2d0fbe48cbfed_2_1380x236.png 2x" data-dominant-color="EBECF6"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">Capture</span><span class="informations">1492×257 15.3 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div><br>
but if only this data loaded in the Slicer, there is not show window in the Slicer.<br>
<div class="lightbox-wrapper"><a class="lightbox" href="https://us1.discourse-cdn.com/flex002/uploads/slicer/original/3X/1/e/1e862914e56ed4ba7de2108da6187302c30e9afe.png" data-download-href="/uploads/short-url/4m1LdBY8y2CgSAnm4xtLnodd4Ci.png?dl=1" title="2" rel="noopener nofollow ugc"><img src="https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/1/e/1e862914e56ed4ba7de2108da6187302c30e9afe_2_690x202.png" alt="2" data-base62-sha1="4m1LdBY8y2CgSAnm4xtLnodd4Ci" width="690" height="202" srcset="https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/1/e/1e862914e56ed4ba7de2108da6187302c30e9afe_2_690x202.png, https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/1/e/1e862914e56ed4ba7de2108da6187302c30e9afe_2_1035x303.png 1.5x, https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/1/e/1e862914e56ed4ba7de2108da6187302c30e9afe_2_1380x404.png 2x" data-dominant-color="F6F6F8"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">2</span><span class="informations">2560×752 66.9 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div><br>
When I loaded the DICOM, only the dicom image is shown.<br>
<div class="lightbox-wrapper"><a class="lightbox" href="https://us1.discourse-cdn.com/flex002/uploads/slicer/original/3X/4/3/4301664398a10ac0a93bf7301fc07504cef756a5.jpeg" data-download-href="/uploads/short-url/9yKZjd2xtJ6WmE2J0bLZNbuqnk1.jpeg?dl=1" title="3.PNG" rel="noopener nofollow ugc"><img src="https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/2X/4/4301664398a10ac0a93bf7301fc07504cef756a5_2_690x372.jpeg" alt="3.PNG" data-base62-sha1="9yKZjd2xtJ6WmE2J0bLZNbuqnk1" width="690" height="372" srcset="https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/2X/4/4301664398a10ac0a93bf7301fc07504cef756a5_2_690x372.jpeg, https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/2X/4/4301664398a10ac0a93bf7301fc07504cef756a5_2_1035x558.jpeg 1.5x, https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/2X/4/4301664398a10ac0a93bf7301fc07504cef756a5_2_1380x744.jpeg 2x" data-dominant-color="959494"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">3.PNG</span><span class="informations">2560×1383 509 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div><br>
and then I choose donot show DICOM image, still nothing in the shown window, even I adjusted the Slice viewer’s FOV.<br>
<div class="lightbox-wrapper"><a class="lightbox" href="https://us1.discourse-cdn.com/flex002/uploads/slicer/original/3X/d/6/d6ef44b6964d0966fcddb1637d602f900b4a1c0a.png" data-download-href="/uploads/short-url/uFoO9lmywWwNmNHSDT8mbuMvS0G.png?dl=1" title="4" rel="noopener nofollow ugc"><img src="https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/2X/d/d6ef44b6964d0966fcddb1637d602f900b4a1c0a_2_690x365.png" alt="4" data-base62-sha1="uFoO9lmywWwNmNHSDT8mbuMvS0G" width="690" height="365" srcset="https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/2X/d/d6ef44b6964d0966fcddb1637d602f900b4a1c0a_2_690x365.png, https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/2X/d/d6ef44b6964d0966fcddb1637d602f900b4a1c0a_2_1035x547.png 1.5x, https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/2X/d/d6ef44b6964d0966fcddb1637d602f900b4a1c0a_2_1380x730.png 2x" data-dominant-color="797979"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">4</span><span class="informations">2560×1357 96.4 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div><br>
There must be something wrong in my operation, but i cannot figure out. Any help is appreciated.</p>

---

## Post #5 by @muratmaga (2020-08-21 04:20 UTC)

<p>Did you try to load the labelmap by itself as is? Does it have anything in it?</p>

---

## Post #7 by @SummerZ2020 (2020-08-21 05:26 UTC)

<p>I tried to load the labelmap(nii.gz) as volume and uncheck SingleFile after check “show options”, the mark  can be shown.<br>
<div class="lightbox-wrapper"><a class="lightbox" href="https://us1.discourse-cdn.com/flex002/uploads/slicer/original/3X/3/9/39314bfde542c1b791470b82a38d00dd60501e34.png" data-download-href="/uploads/short-url/89WPHbjrfVGUXDt1gZf08174grW.png?dl=1" title="Capture" rel="noopener nofollow ugc"><img src="https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/3/9/39314bfde542c1b791470b82a38d00dd60501e34_2_690x122.png" alt="Capture" data-base62-sha1="89WPHbjrfVGUXDt1gZf08174grW" width="690" height="122" srcset="https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/3/9/39314bfde542c1b791470b82a38d00dd60501e34_2_690x122.png, https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/3/9/39314bfde542c1b791470b82a38d00dd60501e34_2_1035x183.png 1.5x, https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/3/9/39314bfde542c1b791470b82a38d00dd60501e34_2_1380x244.png 2x" data-dominant-color="F6F6F6"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">Capture</span><span class="informations">1488×265 12.9 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="https://us1.discourse-cdn.com/flex002/uploads/slicer/original/3X/7/d/7d8e8bf89d45e45d45c27d7c9650717c6de3663a.png" data-download-href="/uploads/short-url/hUJ5vu4rfvZZYRKrw4VS99ZFYzE.png?dl=1" title="Capture1" rel="noopener nofollow ugc"><img src="https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/2X/7/7d8e8bf89d45e45d45c27d7c9650717c6de3663a_2_690x371.png" alt="Capture1" data-base62-sha1="hUJ5vu4rfvZZYRKrw4VS99ZFYzE" width="690" height="371" srcset="https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/2X/7/7d8e8bf89d45e45d45c27d7c9650717c6de3663a_2_690x371.png, https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/2X/7/7d8e8bf89d45e45d45c27d7c9650717c6de3663a_2_1035x556.png 1.5x, https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/2X/7/7d8e8bf89d45e45d45c27d7c9650717c6de3663a_2_1380x742.png 2x" data-dominant-color="8B8A8C"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">Capture1</span><span class="informations">2560×1379 109 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>

---

## Post #8 by @muratmaga (2020-08-21 05:45 UTC)

<p>There seems like a 90 degree rotation with respect to your dicom image. That’s probably why it is not lining up.</p>

---

## Post #9 by @SummerZ2020 (2020-08-21 06:00 UTC)

<p>Thanks <a class="mention" href="/u/muratmaga">@muratmaga</a>. The dicom image size and labelmap image size is both 512*512. So it should not effected by the labelmap is rotation or not. Anyway I will try to adjust the rotation and do it again. I will update later. Thanks again. <img src="https://emoji.discourse-cdn.com/twitter/grinning.png?v=9" title=":grinning:" class="emoji" alt=":grinning:"></p>

---

## Post #10 by @SummerZ2020 (2020-08-21 06:18 UTC)

<p>I tried to load the labelmap which is rotated to the right oritation. But still face the same problem. Is there any documentation I can refer to or some video tutourial? thanks a lot.</p>

---

## Post #11 by @SummerZ2020 (2020-08-21 07:35 UTC)

<p>hi muratmaga, I found the labelmap which loaded from niigz file can be shown as 3D volume. But seems cannot be overlaied on the dicom images. here is the screenshot.<br>
<div class="lightbox-wrapper"><a class="lightbox" href="https://us1.discourse-cdn.com/flex002/uploads/slicer/original/3X/e/0/e0f7264b5c2bd02dcac4b784e150958457f545f4.jpeg" data-download-href="/uploads/short-url/w68t4z1QbuYVAAWI2HaEEol5sGM.jpeg?dl=1" title="Capture1" rel="noopener nofollow ugc"><img src="https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/e/0/e0f7264b5c2bd02dcac4b784e150958457f545f4_2_690x371.jpeg" alt="Capture1" data-base62-sha1="w68t4z1QbuYVAAWI2HaEEol5sGM" width="690" height="371" srcset="https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/e/0/e0f7264b5c2bd02dcac4b784e150958457f545f4_2_690x371.jpeg, https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/e/0/e0f7264b5c2bd02dcac4b784e150958457f545f4_2_1035x556.jpeg 1.5x, https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/e/0/e0f7264b5c2bd02dcac4b784e150958457f545f4_2_1380x742.jpeg 2x" data-dominant-color="ACAEB2"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">Capture1</span><span class="informations">2560×1378 504 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div><br>
Here is the loaded node list.<br>
<div class="lightbox-wrapper"><a class="lightbox" href="https://us1.discourse-cdn.com/flex002/uploads/slicer/original/3X/4/6/463aa0473926b2941570d0d158173a70d25f5aeb.png" data-download-href="/uploads/short-url/a1h1MuhiZfzDpQBkiOYau03baCT.png?dl=1" title="Capture" rel="noopener nofollow ugc"><img src="https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/4/6/463aa0473926b2941570d0d158173a70d25f5aeb_2_639x500.png" alt="Capture" data-base62-sha1="a1h1MuhiZfzDpQBkiOYau03baCT" width="639" height="500" srcset="https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/4/6/463aa0473926b2941570d0d158173a70d25f5aeb_2_639x500.png, https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/4/6/463aa0473926b2941570d0d158173a70d25f5aeb_2_958x750.png 1.5x, https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/4/6/463aa0473926b2941570d0d158173a70d25f5aeb_2_1278x1000.png 2x" data-dominant-color="F7F8F8"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">Capture</span><span class="informations">1383×1082 54.5 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div><br>
How to make them shown together?</p>

---

## Post #12 by @SummerZ2020 (2020-08-21 10:08 UTC)

<p>I tried to save a segmentation as nii.gz file with slicer.util.saveNode(labelmapVolumeNode, nii_path). This nii.gz file can be shown normally with dicom images when it was loaded as segmentation. But the nii.gz file I saved with the code segment below can not work.</p>
<blockquote>
<pre><code>nii = nib.Nifti1Image(segmentation_array, np.eye(4))
</code></pre>
</blockquote>
<pre><code>nib.save(nii, path+'/t_'+batch_dir+'.nii.gz')
</code></pre>
<p>Anything wrong in my code?  Any help would be much appreciated.<br>
t_1_2 in the node list is generated with nib.save. it cannot be shown.<br>
<div class="lightbox-wrapper"><a class="lightbox" href="https://us1.discourse-cdn.com/flex002/uploads/slicer/original/3X/0/7/074d4b3ca68f0eeb8e05c7ca4aee457465390c61.jpeg" data-download-href="/uploads/short-url/12AWvzALUerW5s1r9myan5EOosF.jpeg?dl=1" title="Capture.PNG" rel="noopener nofollow ugc"><img src="https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/2X/0/074d4b3ca68f0eeb8e05c7ca4aee457465390c61_2_690x346.jpeg" alt="Capture.PNG" data-base62-sha1="12AWvzALUerW5s1r9myan5EOosF" width="690" height="346" srcset="https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/2X/0/074d4b3ca68f0eeb8e05c7ca4aee457465390c61_2_690x346.jpeg, https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/2X/0/074d4b3ca68f0eeb8e05c7ca4aee457465390c61_2_1035x519.jpeg 1.5x, https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/2X/0/074d4b3ca68f0eeb8e05c7ca4aee457465390c61_2_1380x692.jpeg 2x" data-dominant-color="A6A6AA"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">Capture.PNG</span><span class="informations">2560×1284 595 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<p>1 in the node list is generated with slicer.util.saveNode. it can be shown.<br>
<div class="lightbox-wrapper"><a class="lightbox" href="https://us1.discourse-cdn.com/flex002/uploads/slicer/original/3X/2/f/2f5fbcbd4ed9d740663757a23826c251a71b691f.jpeg" data-download-href="/uploads/short-url/6L5yy4QNodABlXwCnNh8kfQjq3R.jpeg?dl=1" title="Capture1.PNG" rel="noopener nofollow ugc"><img src="https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/2X/2/2f5fbcbd4ed9d740663757a23826c251a71b691f_2_690x365.jpeg" alt="Capture1.PNG" data-base62-sha1="6L5yy4QNodABlXwCnNh8kfQjq3R" width="690" height="365" srcset="https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/2X/2/2f5fbcbd4ed9d740663757a23826c251a71b691f_2_690x365.jpeg, https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/2X/2/2f5fbcbd4ed9d740663757a23826c251a71b691f_2_1035x547.jpeg 1.5x, https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/2X/2/2f5fbcbd4ed9d740663757a23826c251a71b691f_2_1380x730.jpeg 2x" data-dominant-color="A5A7AC"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">Capture1.PNG</span><span class="informations">2515×1332 598 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>

---

## Post #13 by @lassoan (2020-08-21 16:08 UTC)

<p>You pass an identity matrix to nibabel instead of the IJK to LPS matrix. You can get IJK to RAS matrix from the volume node, convert to IJK to LPS, and pass it to nibabel, but it is easier to just call <code>slicer.util.saveNode()</code> instead. If you want to preserve segment colors, names, etc. then call <code>slicer.util.saveNode()</code> on the segmentation node (not on the exported labelmap volume node).</p>
<p>Note that Nifti file format is for brain MRI images only. As a general-purpose 3D image or segmentation file format, I would recommend to use NRRD instead (it has human-readable header, can store custom metadata, and has many other advantages over Nifti).</p>

---

## Post #15 by @SummerZ2020 (2021-03-29 00:52 UTC)

<p>Thanks a lot, lassoan. I am so happy to see your reply after my long leave(almost seven monthes). unfortunately I have only the nifti file generated by the other program currently. so it cannot be used to load node, right? I tried it just now, and failed with the error “failed to load node from file XXX.nii.gz”. maybe the first solution(get IJK to RAS matrix from the volume node) is the only solution. I can get the IJKtoRAS matrix with the Node.GetIJKToRASMatrix() function. Is there any slicer’s function I can use to convert it to IJKtoLPS matrix? Thanks again. Looking forward to your reply.</p>

---

## Post #16 by @lassoan (2021-03-29 04:42 UTC)

<p>I confirm that loading of segmentation from .nii.gz file works well in recent Slicer versions (in Add data window, choose Description → Segmentation, to load directly as segmentation). If you have any problems with a specific file then the best would be if you could share it with us (upload it somewhere and post the link here).</p>

---

## Post #17 by @SummerZ2020 (2021-03-29 05:25 UTC)

<p>My nifti file’s affine matrix is identity matrix, so it cannot be shown with the volume together. According to your reply in Aug, 20th 2020, I get the solution to get the  IJKtoRAS matrix from the volume data, but how to convert it to IJKtoLPS matrix? Is there some existing function can do this? thank s lot.</p>

---

## Post #18 by @lassoan (2021-03-29 05:30 UTC)

<p>Probably the simplest is to save both the volume and segmentation as .mhd file and then copy the <code>space</code>, <code>space directions</code> and <code>space origin</code> field values from the volume node to the segmentation node.</p>

---

## Post #19 by @SummerZ2020 (2021-03-29 08:02 UTC)

<p>Actually, I am the roobie of Slicer and medical image format. According to your axplaination about the nifti and nrrd, nrrd maybe more suitable to my work, but I only have the binary segmentation result, no header info neither.<br>
I found a solution that save the volume node with saveNode function to nifti image, so I can get the affine matrix from the volume nifti image. But the saveNode return value is ‘False’, where can I find the usage of the saveNode? Sometimes the return value is True, but the output file is not generated in my laptop.<br>
And I want to check the node which I wanna save, but the return result is the memory address. How can I check the content in the memory? See the pic below. Thanks a lot. looking forward to your reply.<br>
<img src="https://us1.discourse-cdn.com/flex002/uploads/slicer/original/3X/6/d/6de07aeaf8b389d2a1b1ee5774ebe18bacaea9b6.png" alt="image" data-base62-sha1="fG0Zqy3SZVqK7K3CpyUO2jVlMou" width="610" height="126"></p>

---

## Post #20 by @SummerZ2020 (2021-03-30 00:45 UTC)

<p>Finally, I found the simple solution donot need to save node. I compared the IJKtoRAS matrix from the volume and the affine matrix from the nifti file（generated by saveNode）. They are totally same. That means IJKtoRAS matrix can be used directly to save nifti. And then import the nifti file again, it can be shown with volume together.<br>
Thanks for all the help.</p>

---
