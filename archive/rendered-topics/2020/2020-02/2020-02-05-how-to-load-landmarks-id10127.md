# How to load landmarks?

**Topic ID**: 10127
**Date**: 2020-02-05
**URL**: https://discourse.slicer.org/t/how-to-load-landmarks/10127

---

## Post #1 by @Tessa_Frank (2020-02-05 14:27 UTC)

<p>Hello,<br>
I have been using the landmark registration tool in 3D slicer. I started this registration yesterday and would like to refine the registration today by adding more landmarks. However, when I opened my saved file, I can see the landmark “fiducials” file, but I cannot get any of the landmarks to load. Could you tell me how to load them?<br>
Many thanks!</p>

---

## Post #2 by @lassoan (2020-02-05 14:29 UTC)

<p>What Slicer version do you use? Does the content of your .fcsv files look valid? Can you load them using File / Add data?</p>

---

## Post #3 by @Tessa_Frank (2020-02-05 15:04 UTC)

<p>We are using version 4.10.2. Our fcsv file does not seem to have any coordinates saved.</p>
<p>After closing the program, is this information gone from the project file or does 3D slicer keep these landmarks internally?</p>
<p>Thank you!</p>

---

## Post #4 by @lassoan (2020-02-05 15:26 UTC)

<p>Slicer only saves markups fiducial point coordinates in the .fcsv file.</p>
<p>Can you reproduce the problem using Slicer-4.10.2 and latest preview release?</p>

---

## Post #5 by @Tessa_Frank (2020-02-06 10:18 UTC)

<p>Sorry, I don’t understand what you mean by the preview release. We are using version 4.10.2. But if I am understanding correctly, you are saying that we must save the landmarkers separately (not just the project file) to be able to access them again. Is this correct?</p>
<p>Thank you!</p>

---

## Post #6 by @manjula (2020-02-06 10:49 UTC)

<p><div class="lightbox-wrapper"><a class="lightbox" href="https://us1.discourse-cdn.com/flex002/uploads/slicer/original/3X/0/8/085b3c3a1e6a07801269d3b8bf2e14021e9092f3.png" data-download-href="/uploads/short-url/1bVi0kXOihy5ImNnUWDeMcFPZXZ.png?dl=1" title="Screenshot from 2020-02-06 11-46-34" rel="noopener nofollow ugc"><img src="https://us1.discourse-cdn.com/flex002/uploads/slicer/original/3X/0/8/085b3c3a1e6a07801269d3b8bf2e14021e9092f3.png" alt="Screenshot from 2020-02-06 11-46-34" data-base62-sha1="1bVi0kXOihy5ImNnUWDeMcFPZXZ" width="690" height="352" data-dominant-color="F4F3F3"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">Screenshot from 2020-02-06 11-46-34</span><span class="informations">1584×810 93.1 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>

---

## Post #7 by @Tessa_Frank (2020-02-06 11:48 UTC)

<p>Ahh okay, we did not see this. We will download soon! Thank you so much!!</p>

---

## Post #8 by @Tessa_Frank (2020-02-11 16:21 UTC)

<p>Using 3D sliver 4.10.2, we were able to solve our problem with the landmarks. They are now loaded and we would like to apply the thinplate registration .</p>
<p>We tried to generate the transformation grid and we believe that we have been successful with this. However, when we try to save the transformation grid, we get an error that states we are unable to save the grid.</p>
<p>When we try to apply the transformation grid (the grid generated by the landmark registration, not the one that was unsuccessfully saved) by using “Resample Scalar/Vector/DWI Volume,” we get a message that the “Resample Scalar/Vector/DWI Volume stopped working. Do you want to end the program.”</p>
<p>Do you have any suggestions for how we can solve this? We are new to this software and cannot understand what we are doing wrong. We are very thankful for your help!</p>

---

## Post #9 by @lassoan (2020-02-11 16:54 UTC)

<aside class="quote no-group" data-username="Tessa_Frank" data-post="8" data-topic="10127">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="24" height="24" src="https://sea2.discourse-cdn.com/flex020/user_avatar/discourse.slicer.org/tessa_frank/48/5923_2.png" class="avatar"> Tessa_Frank:</div>
<blockquote>
<p>However, when we try to save the transformation grid, we get an error that states we are unable to save the grid.</p>
</blockquote>
</aside>
<p>Probably the reason is given in the application log. The problem may have been fixed in more recent Slicer versions.</p>
<aside class="quote no-group" data-username="Tessa_Frank" data-post="8" data-topic="10127">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="24" height="24" src="https://sea2.discourse-cdn.com/flex020/user_avatar/discourse.slicer.org/tessa_frank/48/5923_2.png" class="avatar"> Tessa_Frank:</div>
<blockquote>
<p>When we try to apply the transformation grid (the grid generated by the landmark registration, not the one that was unsuccessfully saved) by using “Resample Scalar/Vector/DWI Volume,” we get a message that the “Resample Scalar/Vector/DWI Volume stopped working. Do you want to end the program.”</p>
</blockquote>
</aside>
<p>Inability to save the transform may be the root cause. You can also apply a transformation by hardening the transform on the selected node in Transforms module.</p>

---

## Post #10 by @Tessa_Frank (2020-02-11 17:24 UTC)

<p>Thank you so much for the quick reply. We did download version 4.11.0 but when we opened the file and tried landmark registration, the resulting registration was completely off. I am not sure if somehow the landmarks changed/were misaligned in the new version, but we could not use the registration at all in the. This is why we did not continue with the new version.</p>

---

## Post #11 by @pieper (2020-02-11 17:58 UTC)

<p>Yes, the LandmarkRegistration module is very broken in the current nightly.  It hasn’t been updated and I guess I’ll disable it until there are resources to work on it (I just haven’t had time to dig in).</p>
<p>[Edit - it <a href="http://viewvc.slicer.org/viewvc.cgi/Slicer4?view=revision&amp;revision=28766">will be off</a> for now]</p>

---

## Post #12 by @lassoan (2020-02-11 19:23 UTC)

<p><a class="mention" href="/u/pieper">@pieper</a> Could you transfer the Landmark registration repository to <code>Slicer</code> organization? That way it would be easier to make changes right away when we make changes in Slicer core.</p>

---

## Post #13 by @lassoan (2020-02-11 19:27 UTC)

<aside class="quote no-group" data-username="Tessa_Frank" data-post="10" data-topic="10127">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="24" height="24" src="https://sea2.discourse-cdn.com/flex020/user_avatar/discourse.slicer.org/tessa_frank/48/5923_2.png" class="avatar"> Tessa_Frank:</div>
<blockquote>
<p>We did download version 4.11.0 but when we opened the file and tried landmark registration, the resulting registration was completely of</p>
</blockquote>
</aside>
<p>You can use “Fiducial registration wizard” module in SlicerIGT extension. “Landmark registration” is optimized for tuning slight alignment differences in images, while “Fiducial registration wizard” is a general-purpose landmark registration module, but both can be used to get the job done.</p>

---

## Post #14 by @pieper (2020-02-11 20:06 UTC)

<aside class="quote no-group" data-username="lassoan" data-post="12" data-topic="10127">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="24" height="24" src="https://sea2.discourse-cdn.com/flex020/user_avatar/discourse.slicer.org/lassoan/48/13_2.png" class="avatar"> lassoan:</div>
<blockquote>
<p>Could you transfer the Landmark registration repository to <code>Slicer</code> organization?</p>
</blockquote>
</aside>
<p>Okay, done.  I started looking for fixes a couple times but didn’t have time to finish.  If we can sort out some core issues the rest is probably not hard.  I think the main thing is adapting to the fiducial creation and placement events.</p>
<p>Maybe also we can think of a more robust way to differentiate the concepts of fiducial (a fixed point in space) from the concept of landmark (corresponding points on multiple data objects).  A lot of the custom-code in LandmarkRegistration is about making sure that landmarks are only visible on the datasets to which they belong using naming conventions, but there could be better ways.</p>

---

## Post #15 by @Tessa_Frank (2020-02-12 16:05 UTC)

<p>We tried to use the “Fiducial registration wizard” module in the SlicerIGT extension, but were unable to figure out how to properly place the landmarks. It seems that if you moved xy in one image, it moved xy in the second image as well. Only z was able to be manipulated differently in the two images. To register our images, we must be able to manipulate xyz.</p>
<p>We played more with the landmark registration in version 4.10.2 and were finally able to get this to work. It seems that there is a limit to the number of landmarks you can use. Our original file had 51 landmarks and with this, we could not create the transformation grid. We cropped the image and have continued to use under 30 landmarks and were able to load and apply the transformation grid. So, we believe that the problem is that there is a limit to the number of landmarks that can be used to successfully produce the transformation grid.</p>
<p>Many thanks for all of your help and suggestions! We will look out for the landmark registration in version 4.11 when it is ready.</p>

---

## Post #16 by @lassoan (2020-02-13 01:03 UTC)

<aside class="quote no-group" data-username="Tessa_Frank" data-post="15" data-topic="10127">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="24" height="24" src="https://sea2.discourse-cdn.com/flex020/user_avatar/discourse.slicer.org/tessa_frank/48/5923_2.png" class="avatar"> Tessa_Frank:</div>
<blockquote>
<p>We tried to use the “Fiducial registration wizard” module in the SlicerIGT extension, but were unable to figure out how to properly place the landmarks</p>
</blockquote>
</aside>
<p>You can drop the landmarks in any view (including volume rendered surfaces in 3D view). If you use a recent Slicer Preview Release then you can click on a point to show it in all views and then drag-and-drop it in any of the views (this is how you move it between slices, not just within a slice).</p>

---
