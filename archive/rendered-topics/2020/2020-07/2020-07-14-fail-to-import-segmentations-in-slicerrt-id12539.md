# Fail to import segmentations in SlicerRT

**Topic ID**: 12539
**Date**: 2020-07-14
**URL**: https://discourse.slicer.org/t/fail-to-import-segmentations-in-slicerrt/12539

---

## Post #1 by @loubna (2020-07-14 18:40 UTC)

<p>Hi;</p>
<p>I have a set of T3 images segmented using SFL software Library. The segmentations are saved in .nii format. The dicom images and segmentations are well imported in 3D slicer. (see figure 1) however when I export them in slicer RT only the images are exported (without segmentations).</p>
<p>loading images + segmentations process in 3D slicer<br>
1- import .dcm images<br>
2- in segmentations module -&gt;Active segmentation, I have create new segmentation<br>
3- In export/Import models/labels, I have chosen segmentation and click on import<br>
4- Now in segment editor , I have the three segments : CSF, gray and white matter<br>
5- click on show 3d to display the 3D model<br>
(see figure 1)<br>
Now, I would export the all as DicomRT, But I am  confused (see figure 2) between right click on study then export to Dicom, but what about segmentation (segment1,segment2,segment3) are not exported.</p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="https://us1.discourse-cdn.com/flex002/uploads/slicer/original/3X/e/8/e8a68875501c57be4d445ea20b353a81190af9d5.png" data-download-href="/uploads/short-url/xc7zfshk1sjzd1dQm2vtBs3RjQF.png?dl=1" title="fig1" rel="noopener nofollow ugc"><img src="https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/e/8/e8a68875501c57be4d445ea20b353a81190af9d5_2_690x311.png" alt="fig1" data-base62-sha1="xc7zfshk1sjzd1dQm2vtBs3RjQF" width="690" height="311" srcset="https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/e/8/e8a68875501c57be4d445ea20b353a81190af9d5_2_690x311.png, https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/e/8/e8a68875501c57be4d445ea20b353a81190af9d5_2_1035x466.png 1.5x, https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/e/8/e8a68875501c57be4d445ea20b353a81190af9d5_2_1380x622.png 2x" data-dominant-color="8D8C93"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">fig1</span><span class="informations">1896×856 478 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<p><img src="https://us1.discourse-cdn.com/flex002/uploads/slicer/original/3X/d/a/dad919099322e24f8dea95e7b5ace02f96b67dec.png" alt="fig2" data-base62-sha1="ve1dxJLHqmXCcI2DTzBvO3a873m" width="548" height="265"></p>
<p>Any help please and thank’s in advance</p>

---

## Post #2 by @Sunderlandkyl (2020-07-14 18:58 UTC)

<p>You need to drag the Segmentation into the study. Ex:<br>
<img src="https://us1.discourse-cdn.com/flex002/uploads/slicer/original/3X/3/9/39ec5759c6359533741e5e94d70018f922b1497f.png" alt="image" data-base62-sha1="8gpzCuGBl5TC9F2PZ9kkB112uwD" width="329" height="178"></p>

---

## Post #3 by @loubna (2020-07-15 09:21 UTC)

<p>Thank you very much for reply,</p>
<p>I followed the montioned steps, but I have got these errors:</p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="https://us1.discourse-cdn.com/flex002/uploads/slicer/original/3X/6/5/65d54d0776ba5183d490064769adad97be28a454.png" data-download-href="/uploads/short-url/ewRdC305WYmijsRzrB7sBsixepS.png?dl=1" title="bug" rel="noopener nofollow ugc"><img src="https://us1.discourse-cdn.com/flex002/uploads/slicer/original/3X/6/5/65d54d0776ba5183d490064769adad97be28a454.png" alt="bug" data-base62-sha1="ewRdC305WYmijsRzrB7sBsixepS" width="396" height="500" data-dominant-color="202020"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">bug</span><span class="informations">646×815 12.1 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div><br>
sometimes, it tells that contours are not parallel and slicer crash</p>

---

## Post #4 by @Sunderlandkyl (2020-07-15 14:55 UTC)

<p>There was a bug in Slicer 4.10 that caused an error when trying to export segments as RTSTRUCT.</p>
<p>Could you try with the latest nightly preview release?</p>

---

## Post #5 by @loubna (2020-07-15 19:21 UTC)

<p>even with latest nightly, it does not work.</p>
<p>we have tried generate segmentation from 3T images using 3d slicer Tools and export them as DICOMRT to see if the problem comes from 3T images or segmentations generated by SFL Library.</p>
<p>the segmentation is exported , however we have the Following warnings (contour planes are not parallel).</p>
<p><img src="https://us1.discourse-cdn.com/flex002/uploads/slicer/original/3X/2/7/277db8f872c6d9c577652ff59d2f832a613070e1.png" alt="bug1" data-base62-sha1="5DlYNCcIq2W6aJ49436o8iORC8x" width="647" height="482"></p>
<p>I think that the first problem comes from the 3T images, then slicerRT is unable to convert segmentation to a set of parallel contours.</p>
<p>the Following image represents one segment reconstructed in 3d slicer by flying edges. I dont understand if the problem comes from 3T images or from segmentations generated by sfl</p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="https://us1.discourse-cdn.com/flex002/uploads/slicer/original/3X/3/b/3b0883f9b223cdaf6fde91e7fc597f5b4db81ef8.png" data-download-href="/uploads/short-url/8qepK04Bx8lGfaVvbsmAtY2yXhu.png?dl=1" title="seg1" rel="noopener nofollow ugc"><img src="https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/3/b/3b0883f9b223cdaf6fde91e7fc597f5b4db81ef8_2_690x376.png" alt="seg1" data-base62-sha1="8qepK04Bx8lGfaVvbsmAtY2yXhu" width="690" height="376" srcset="https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/3/b/3b0883f9b223cdaf6fde91e7fc597f5b4db81ef8_2_690x376.png, https://us1.discourse-cdn.com/flex002/uploads/slicer/original/3X/3/b/3b0883f9b223cdaf6fde91e7fc597f5b4db81ef8.png 1.5x, https://us1.discourse-cdn.com/flex002/uploads/slicer/original/3X/3/b/3b0883f9b223cdaf6fde91e7fc597f5b4db81ef8.png 2x" data-dominant-color="718886"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">seg1</span><span class="informations">855×466 277 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>

---

## Post #6 by @Sunderlandkyl (2020-07-15 19:34 UTC)

<p>If you could upload the data somewhere, I’ll take a look at it.</p>

---

## Post #7 by @loubna (2020-07-21 07:33 UTC)

<p>Hi Mr;</p>
<p>I send you an email, because I can not share data on forum.</p>
<p>Thank’s for understanding!</p>

---

## Post #8 by @Sunderlandkyl (2020-07-21 15:55 UTC)

<p>Thank you! I will take a look at it!</p>

---

## Post #9 by @loubna (2020-08-03 14:14 UTC)

<p>I have tried other examples (for example this one: <a href="https://www.fmrib.ox.ac.uk/primers/intro_primer/ExBox3/IntroBox3.html" rel="nofollow noopener">https://www.fmrib.ox.ac.uk/primers/intro_primer/ExBox3/IntroBox3.html</a>) But unfortunately it does not work.</p>
<p>Otherwise, I compiled BrainStructuresSegmenter extension in order to extract (CSF,white and gray matters) from T1 images but it seems that it does not work.</p>
<p>if you have other suggestions, I will be  grateful</p>
<p>thank’s in advance</p>

---

## Post #10 by @Sunderlandkyl (2020-08-03 14:55 UTC)

<p>I have not had an opportunity to take a look at this issue yet, but I should have time this week.<br>
Thanks for your patience!</p>

---

## Post #11 by @lassoan (2020-08-03 15:29 UTC)

<p>I’ve tried loading <a href="https://www.fmrib.ox.ac.uk/primers/intro_primer/ExBox3/IntroBox3.html">these</a> files and Slicer loaded and visualized them perfectly.</p>
<p>For loading segmentation files, I would recommend to choose “Segmentation” in “Description” column.</p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="https://us1.discourse-cdn.com/flex002/uploads/slicer/original/3X/9/c/9c2bd49dfc2db92a43109854aae45656acb0e8a5.png" data-download-href="/uploads/short-url/mhyoinSQflkx4wr6i6rLBrJTCYd.png?dl=1" title="image"><img src="https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/9/c/9c2bd49dfc2db92a43109854aae45656acb0e8a5_2_690x172.png" alt="image" data-base62-sha1="mhyoinSQflkx4wr6i6rLBrJTCYd" width="690" height="172" srcset="https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/9/c/9c2bd49dfc2db92a43109854aae45656acb0e8a5_2_690x172.png, https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/9/c/9c2bd49dfc2db92a43109854aae45656acb0e8a5_2_1035x258.png 1.5x, https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/9/c/9c2bd49dfc2db92a43109854aae45656acb0e8a5_2_1380x344.png 2x" data-dominant-color="F5F5F8"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">image</span><span class="informations">1569×392 18.8 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<p>Result (after creating “Closed surface” representation in Segmentations module):</p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="https://us1.discourse-cdn.com/flex002/uploads/slicer/original/3X/5/b/5b629ff9c822d5299b7d8bac7a511ee64da50b28.jpeg" data-download-href="/uploads/short-url/d2qKFmquGFKXIb9JfqfeQIKxLkY.jpeg?dl=1" title="image"><img src="https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/2X/5/5b629ff9c822d5299b7d8bac7a511ee64da50b28_2_690x413.jpeg" alt="image" data-base62-sha1="d2qKFmquGFKXIb9JfqfeQIKxLkY" width="690" height="413" srcset="https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/2X/5/5b629ff9c822d5299b7d8bac7a511ee64da50b28_2_690x413.jpeg, https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/2X/5/5b629ff9c822d5299b7d8bac7a511ee64da50b28_2_1035x619.jpeg 1.5x, https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/2X/5/5b629ff9c822d5299b7d8bac7a511ee64da50b28_2_1380x826.jpeg 2x" data-dominant-color="939395"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">image</span><span class="informations">2289×1372 842 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<p>You may disable smoothing to reduce number of holes in the generated surface but overall the segmentation is quite low resolution/quality, so it will not produce continuous surface.</p>
<p>You can also use <a href="https://github.com/PerkLab/SlicerFreeSurfer">SlicerFreeSurfer extension</a> to import FreeSurfer files.</p>

---

## Post #12 by @loubna (2020-08-04 08:36 UTC)

<p>Thank you very much for reply. Of course, Slicer can reconstruct perfectly the 3d surfaces corresponding to segmentations using Flying edges. But it is still unable to export them as closed contours (DICOM RT). I think because of holes in the generated segmentations by FSL.</p>

---

## Post #13 by @lassoan (2020-08-04 12:05 UTC)

<p>DICOM RT structure set stores segmentation as a set of parallel contours, therefore in practice it can only store very simple shapes and not the very intricate shape of a noisy, poor-quality segmentation. You can store the segmentation as a DICOM Segmentation Object instead, which stores segmentation as a labelmap.</p>

---

## Post #14 by @loubna (2020-08-04 12:30 UTC)

<p>Thank’s for clarification</p>

---
