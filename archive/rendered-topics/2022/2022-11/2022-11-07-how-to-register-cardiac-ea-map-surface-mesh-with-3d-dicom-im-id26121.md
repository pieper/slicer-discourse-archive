---
topic_id: 26121
title: "How To Register Cardiac Ea Map Surface Mesh With 3D Dicom Im"
date: 2022-11-07
url: https://discourse.slicer.org/t/26121
---

# How to register cardiac EA map surface mesh with 3D DICOM image

**Topic ID**: 26121
**Date**: 2022-11-07
**URL**: https://discourse.slicer.org/t/how-to-register-cardiac-ea-map-surface-mesh-with-3d-dicom-image/26121

---

## Post #1 by @jrf (2022-11-07 23:42 UTC)

<p>I have little experience using Slicer. I want to register a vtk file with a DICOM and export it to a DICOM that can later be used in the clinic.<br>
I have been able to import the vtk files with the EAMapReader extension and also the CT scan but I cannot register.<br>
I don‚Äôt know if this forum is the right one to ask this question but I would appreciate any help. Thanks in advance</p>

---

## Post #2 by @pieper (2022-11-08 13:41 UTC)

<p>It‚Äôs possible that this can be done, but a lot depends on the details like coordinate system assumptions and whether the data has sufficient information to correctly make the alignment.  To get better help, you can post more information such as what brands of equipment you are using, what methods you used to export, etc.  Ideally you would supply deidentified or even phantom data that replicates the issue you are trying to solve.</p>

---

## Post #3 by @lassoan (2022-11-08 14:17 UTC)

<p>You can use matching anatomical landmark points for alignment see <a href="https://slicer.readthedocs.io/en/latest/user_guide/registration.html">registration page</a> for details.</p>
<p>What would you like to do with the map exported to DICOM format? Overlay it on fluoro or CT/MRI images in 3D? In what software? Or you would you like to export just screenshots or videos that clinicians can watch in their PACS viewers?</p>
<p>What is the clinical problem you are trying to solve and how?</p>

---

## Post #4 by @jrf (2022-11-08 23:19 UTC)

<p>I will explain the problem in more detail: we are implementing a technique for treating cardiac arrhythmias with radioablation.<br>
The treatments are planned in a CT scan using RayStation software in which the target volumes (ROIs) are delimited. To delimit the area to be treated correctly we need to incorporate the images generated by the electrocardiographic mapping systems (in our case the ADAS 3d software). This system generates a .vtk file (model) with the target structures. The planning CT together with the vtk files are imported to the Slicer (using the EAMapReader extension) for registration and definition of the target volumes that will then be exported to the planner for treatment planning. I do not know if I have explained well. The procedure is described in the article "A novel open-source software-based high-precision workflow for target definition in cardiac radioablation. Hohmann et al. <a href="https://onlinelibrary.wiley.com/doi/full/10.1111/jce.14660" rel="noopener nofollow ugc">https://onlinelibrary.wiley.com/doi/full/10.1111/jce.14660</a><br>
The article does not give details about the steps to be followed in the Slicer.<br>
Thanks for your replies.<br>
Jes√∫s</p>

---

## Post #5 by @pieper (2022-11-09 00:28 UTC)

<p>Thank you for the extra context, it helps make clear what you have in mind.  I don‚Äôt know if anyone here has experience with the particular clinical systems you mentioned, but in any case it would be good to contact the vendors and ask them to provide you with the specifications for the data they export (what coordinate reference LPS or RAS, what units, what DICOM frame of reference, etc). These are not in the VTK file so you need this information from another source.  You may be able to figure this out by guessing but it would be better to confirm what you expect to get on an ongoing basis.  There was a change in VTK a few years ago in the way certain files were written and it broke many research workflows of the type you are describing.  DICOM RT files are generally more standards compliant but it‚Äôs better to remove any ambiguity by confirming your assumptions .  Also you could contact the corresponding author of the cited paper to confirm any details that were not clear in the publication.</p>

---

## Post #6 by @jrf (2022-11-09 21:50 UTC)

<p>Steve,<br>
I finally contacted the vendors of the cardiac mapping system and they have provided me with the files in DICOM RT format with the structures so that I can use it perfectly with my radiotherapy planner and perform the treatment safely.<br>
Anyway I will continue to research the subject just for scientific interest in knowing how the procedure is.<br>
Thank you for your reply</p>

---

## Post #7 by @lassoan (2022-11-10 21:20 UTC)

<p>Actually Carto saves the electro anatomical map in VTK file format (and it can even read VTK files that are exported using SlicerHeart extension‚Äôs Carto Export module).</p>
<p>The electroanatomical map files (VTK and a few other formats) can be read into Slicer using <a class="mention" href="/u/stephan">@stephan</a> 's (first author of the paper you cited above) Slicer extension. If the map was created from a CT then they should be already aligned. If the map is created just from the electromagnetic tracker of Carto (without importing a CT) then you need to register them (e.g., using landmarks).</p>
<p>Once you have the map registered with the CT, you can create a segmentation for the CT, mark the targets in the CT using Segment Editor (by looking at the nice, full-color map and paint small spheres in 3D view) and export it as DICOM RT Structure Set, which you can load into your radiation treatment planning system.</p>

---

## Post #8 by @stephan (2022-11-10 21:30 UTC)

<p>Hi jrf,<br>
Just came across this thread because <a class="mention" href="/u/lassoan">@lassoan</a>  mentioned me.<br>
I have no experience with ADAS 3D (besides knowing it exists), but for more detail on the registration and target definition in Slicer /EAMapReader, there is a"live-in-the-box" case I recorded for a workshop a while ago:</p>
<p>            <iframe src="https://www.youtube.com/embed/videoseries?list=PLkoKNyhBHtxIMxLQvD329ebx2DzRrKgpz&amp;wmode=transparent&amp;rel=0&amp;autohide=1&amp;showinfo=1&amp;enablejsapi=1" width="480" height="360" frameborder="0" allowfullscreen="" class="youtube-onebox" seamless="seamless" sandbox="allow-same-origin allow-scripts allow-forms allow-popups allow-popups-to-escape-sandbox allow-presentation"></iframe>
</p>
<p>It‚Äôs actually 3 movies, total approx. 50 minutes playing time, that show the workflow in 3D Slicer in some detail.</p>
<p>Let me know if you have any additional questions.</p>
<p>Best regards<br>
Stephan</p>

---

## Post #9 by @jrf (2022-11-10 22:00 UTC)

<p>Hi Stephan<br>
I have just started watching the video tutorials and they describe in detail the steps to follow in Slicer. It‚Äôs just what I needed!!<br>
ADAS 3D also allows you to export to a vtk file, so I think the procedure will be the same or very similar to the one you describe in the videos.<br>
Thank you very much for your help.<br>
Jesus</p>

---

## Post #10 by @jrf (2022-11-10 22:04 UTC)

<p>Andras<br>
Thank you for your help in solving the problem.<br>
Jes√∫s</p>

---

## Post #11 by @stephan (2022-11-13 20:02 UTC)

<p>Since the youtube link has been replaced with the embedded video, I‚Äôll post the playlist URL once again:<br>
<a href="https://www.youtube.com/playlist?list=PLkoKNyhBHtxIMxLQvD329ebx2DzRrKgpz" rel="noopener nofollow ugc">https://www.youtube.com/playlist?list=PLkoKNyhBHtxIMxLQvD329ebx2DzRrKgpz</a></p>

---

## Post #12 by @Raha_Sep (2022-12-23 12:58 UTC)

<p>Hi Stephan,<br>
Could you please put the link to download the <strong>Carto7Convert.exe</strong> as you mentioned in the video? I couldn‚Äôt find it.<br>
Thank you in advance,<br>
Raha</p>

---

## Post #13 by @stephan (2022-12-30 15:25 UTC)

<p>You can find the executable here: <a href="https://drive.google.com/drive/folders/1Uc6rzoL9yNBJTSEBRksZyTi3J7t7uKx3?usp=share_link" class="inline-onebox" rel="noopener nofollow ugc">Software - Google Drive</a></p>

---

## Post #14 by @Raha_Sep (2022-12-30 15:27 UTC)

<p>Dear Stephan,<br>
Thank you for your help‚úåüèº<br>
Regards, Rahi</p>

---
