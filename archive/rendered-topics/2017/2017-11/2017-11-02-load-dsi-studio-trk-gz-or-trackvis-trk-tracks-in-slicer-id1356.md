---
topic_id: 1356
title: "Load Dsi Studio Trk Gz Or Trackvis Trk Tracks In Slicer"
date: 2017-11-02
url: https://discourse.slicer.org/t/1356
---

# Load DSI Studio (*.trk.gz) or TrackVis (*.trk) tracks in Slicer

**Topic ID**: 1356
**Date**: 2017-11-02
**URL**: https://discourse.slicer.org/t/load-dsi-studio-trk-gz-or-trackvis-trk-tracks-in-slicer/1356

---

## Post #1 by @jcfr (2017-11-02 18:27 UTC)

<p>Does anyone have experience converting and then loading fibertrack generated by these software into 3D Slicer ?</p>
<p>Is there any recommended pathway to export tracts and import them into Slicer ?</p>
<p>We are thinking of  these approaches:</p>
<ul>
<li>improve export to vtk (fiberbundle)  in software like DSI Studio.</li>
<li>add IO support for <code>.trk.gz</code>, <code>.trk</code> …</li>
</ul>
<p>Thanks for your input</p>
<p>References:</p>
<ul>
<li>format <code>.trk.gz</code>: <a href="http://dsi-studio.labsolver.org/">http://dsi-studio.labsolver.org/</a> / <a href="http://dsi-studio.labsolver.org/system/app/pages/subPages?path=/Manual" class="inline-onebox">Subpages - DSI Studio—A Tractography Software Tool</a>
</li>
<li>format <code>.trk</code>:  <a href="http://www.trackvis.org/">http://www.trackvis.org/</a> / <a href="http://www.trackvis.org/docs/?subsect=fileformat" class="inline-onebox">TrackVis :: Documentation</a>
</li>
<li>vtk fiberbundle is supported by SlicerDMRI thanks to <a href="https://github.com/SlicerDMRI/SlicerDMRI/blob/master/Modules/Loadable/TractographyDisplay/MRML/vtkMRMLFiberBundleStorageNode.h">vtkMRMLFiberBundleStorageNode</a> and <a href="https://github.com/SlicerDMRI/SlicerDMRI/blob/master/Modules/Loadable/TractographyDisplay/MRML/vtkMRMLFiberBundleNode.h">vtkMRMLFiberBundleNode</a>
</li>
</ul>
<p>Cc: <a class="mention" href="/u/johan_andruejol">@Johan_Andruejol</a> <a class="mention" href="/u/fbudin69500">@fbudin69500</a></p>

---

## Post #2 by @ihnorton (2017-11-02 23:51 UTC)

<p>I have code to load TrackVis-style trk files. It can create Slicer-style vtkPolyData in memory so would be pretty simple to hook it up as another i/o option. It uses C++11 features, but it’s only a few hundred lines so could be modified … unless we’re flipping switch soon! <img src="https://emoji.discourse-cdn.com/twitter/stuck_out_tongue_winking_eye.png?v=5" title=":stuck_out_tongue_winking_eye:" class="emoji" alt=":stuck_out_tongue_winking_eye:"></p>
<p>Have never used DSI Studio data though.</p>

---

## Post #3 by @lassoan (2017-11-04 14:39 UTC)

<p><a class="mention" href="/u/jcfr">@jcfr</a> When do we plan to switch to c++11? I have trouble building Cleaver on Linux and Mac without c++11, too.</p>

---

## Post #4 by @Vinny (2018-01-26 01:10 UTC)

<p>I have been generating .trk streamlines in Dipy and would like to export them to 3d Slicer for visualization and overlay onto images.  How can .trk files be imported into 3d Slicer?  Thanks</p>

---

## Post #5 by @jamesjcook (2018-02-07 21:13 UTC)

<p>Building on the work of <a class="mention" href="/u/ihnorton">@ihnorton</a>, <a class="mention" href="/u/johan_andruejol">@Johan_Andruejol</a> and <a class="mention" href="/u/jcfr">@jcfr</a> solved this for us, the github for the code is here.</p>
<aside class="onebox allowlistedgeneric" data-onebox-src="https://github.com/InteractivePublishing/TrackConverterCLI">
  <header class="source">
      <img src="https://github.githubassets.com/favicons/favicon.svg" class="site-icon" width="32" height="32">

      <a href="https://github.com/InteractivePublishing/TrackConverterCLI" target="_blank" rel="noopener nofollow ugc">GitHub</a>
  </header>

  <article class="onebox-body">
    <div class="aspect-image" style="--aspect-ratio:690/345;"><img src="https://opengraph.githubassets.com/53e620603bf22baf6def8c3fde1c8c6c35cfb74e9a562f2c46ab9af4c1f827d5/InteractivePublishing/TrackConverterCLI" class="thumbnail" width="690" height="345"></div>

<h3><a href="https://github.com/InteractivePublishing/TrackConverterCLI" target="_blank" rel="noopener nofollow ugc">GitHub - InteractivePublishing/TrackConverterCLI: Convert trk(.gz)? files to...</a></h3>

  <p>Convert trk(.gz)? files to vtk poly lines. Adapated to work with InteractivePublishing's copy of slicer. - GitHub - InteractivePublishing/TrackConverterCLI: Convert trk(.gz)? files to vtk poly ...</p>


  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

<p>I managed to compile in windows with vs 2013.</p>
<p>To make it run it needs to be able to find the dll’s from your compiled copy of slicer. I grabbed all the dll files and threw them in the same directory with the exe. That is the wrong solution, but it works.</p>

---

## Post #6 by @Vinny (2018-02-08 23:25 UTC)

<p>Perfect will try it out.  Thanks!</p>

---

## Post #7 by @samuelholly (2019-01-25 12:19 UTC)

<p>Dear all,</p>
<p>TrackVis can save fibers as VTK polydata which can be directly imported to Slicer.</p>
<p>Best regards</p>

---

## Post #8 by @SteveJJ (2020-11-24 16:23 UTC)

<p>Please can you explain how this is done? It is not clear from the menus in TracVis</p>
<p>Thanks!<br>
Steve</p>

---

## Post #9 by @samuelholly (2020-11-25 10:25 UTC)

<p>Dear Steve,</p>
<p>when you right-click any track group in the sidepanel, there’s a “Save as…” option. In the dialog that pops-up, you can change the format from .trk to .vtk.</p>
<p>You will be asked to provide an appropriate reference volume (I think to get the correct transformation).</p>
<p>This works for version 0.6.1. I’m not sure about previous versions (though it may work as well).</p>
<p>Best regards</p>
<p>Samuel</p>

---

## Post #10 by @Eleftherios (2021-07-15 16:18 UTC)

<p>Dear <a class="mention" href="/u/vinny">@Vinny</a> and all, DIPY has a command called <code>save_vtk</code> see here<br>
<a href="https://dipy.org/documentation/1.3.0./reference/dipy.io/#dipy.io.streamline.save_vtk" rel="noopener nofollow ugc">https://dipy.org/documentation/1.3.0./reference/dipy.io/#dipy.io.streamline.save_vtk</a><br>
Which means that you can load the TRK file with DIPY and then save it as VTK.<br>
Which also means that as you are already using DIPY to do your tracking you can save the result directly to both VTK and TRK (along with TCK and DPY file formats).</p>
<p>I hope this information helps.<br>
Eleftherios</p>

---

## Post #11 by @Vinny (2021-07-15 23:21 UTC)

<p>Thanks <a class="mention" href="/u/eleftherios">@Eleftherios</a>, this is very helpful!</p>

---

## Post #12 by @Eleftherios (2021-07-16 15:28 UTC)

<p>Happy to help <a class="mention" href="/u/vinny">@Vinny</a>. Let me know if you have any other questions. I wish I have seen this question earlier. Have in mind that I do not check this discourse channel that often. You may want to ask any other related questions on DIPY’s live chatroom (or forum) available here</p><aside class="onebox allowlistedgeneric" data-onebox-src="https://gitter.im/dipy/dipy">
  <header class="source">
      <img src="https://cdn03.gitter.im/_s/607e329c0/images/favicon-normal.ico" class="site-icon" width="32" height="32">

      <a href="https://gitter.im/dipy/dipy" target="_blank" rel="noopener nofollow ugc">gitter.im</a>
  </header>

  <article class="onebox-body">
    <img src="https://avatars-02.gitter.im/group/iv/4/5ebea80dd73408ce4fe3df29" class="thumbnail onebox-avatar" width="128" height="128">

<h3><a href="https://gitter.im/dipy/dipy" target="_blank" rel="noopener nofollow ugc">dipy/dipy</a></h3>

  <p>Diffusion MR Imaging in Python</p>


  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>
<aside class="onebox allowlistedgeneric" data-onebox-src="https://github.com/dipy/dipy/discussions">
  <header class="source">
      <img src="https://github.githubassets.com/favicons/favicon.svg" class="site-icon" width="32" height="32">

      <a href="https://github.com/dipy/dipy/discussions" target="_blank" rel="noopener nofollow ugc">GitHub</a>
  </header>

  <article class="onebox-body">
    <div class="aspect-image" style="--aspect-ratio:690/345;"><img src="https://opengraph.githubassets.com/1bda6473ef491579d8257eb58341c8e5e1389556cac43d59ae99206b043e49a3/dipy/dipy" class="thumbnail" width="690" height="345"></div>

<h3><a href="https://github.com/dipy/dipy/discussions" target="_blank" rel="noopener nofollow ugc">dipy/dipy</a></h3>

  <p>DIPY is the paragon 3D/4D+ imaging library in Python. Contains generic methods for spatial normalization, signal processing, machine learning, statistical analysis and visualization of medical imag...</p>


  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>
<p>
Best,<br>
Eleftherios</p>

---

## Post #13 by @lassoan (2021-07-17 06:12 UTC)

<aside class="quote no-group" data-username="Eleftherios" data-post="12" data-topic="1356">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="24" height="24" src="https://sea2.discourse-cdn.com/flex020/user_avatar/discourse.slicer.org/eleftherios/48/11643_2.png" class="avatar"> Eleftherios:</div>
<blockquote>
<p>Let me know if you have any other questions. I wish I have seen this question earlier. Have in mind that I do not check this discourse channel that often.</p>
</blockquote>
</aside>
<p>If you don’t have time to visit this forum regularly but would like to answer questions related to dipy then you can enable email notification for topics posted in the <a href="https://discourse.slicer.org/c/community/slicerdmri/16">SlicerDMRI category</a> or tagged with <a href="https://discourse.slicer.org/tag/diffusion">diffusion</a> by going to the category’s or tag’s page, clicking the “bell” icon, and choosing “watching”. I don’t think the amount of messages will be overwhelming, but if you prefer then we can even create a <code>dipy</code> tag so that you can sign up for notifications about topics specifically about dipy.</p>

---

## Post #14 by @Eleftherios (2021-07-22 20:21 UTC)

<p>Thank you <a class="mention" href="/u/lassoan">@lassoan</a> will do as suggested. Be happy to create a dipy tag.</p>

---

## Post #15 by @lassoan (2021-07-22 20:49 UTC)

<p>Done, see here: <a href="https://discourse.slicer.org/tag/dipy">https://discourse.slicer.org/tag/dipy</a></p>
<p>You could also sign up to the <a href="https://discourse.slicer.org/tag/dipy">diffusion tag</a> so that you can direct people towards dipy who have not heard about it yet and would benefit from using it.</p>

---

## Post #16 by @pieper (2021-07-22 20:59 UTC)

<p>Now that Slicer users can <code>pip_install("dipy")</code> it will be great to see what new things are possible.</p>

---

## Post #17 by @nayanw775 (2022-07-28 11:05 UTC)

<p><a class="mention" href="/u/eleftherios">@Eleftherios</a> I am wondering, with Dipy or slicer is it possible to convert the .tck into dicom, so that it can be used into to PACS or navigation systems?</p>

---
