# Skeleton, measuring a curve length

**Topic ID**: 1665
**Date**: 2017-12-15
**URL**: https://discourse.slicer.org/t/skeleton-measuring-a-curve-length/1665

---

## Post #1 by @brhoom (2017-12-15 10:06 UTC)

<p>Operating system: Ubuntu 16<br>
Slicer version: 4.8<br>
Expected behavior: getting an output<br>
Actual behavior: infinite loop</p>
<p>Dear all,<br>
I have few questions related automatic measurement the length of an object in Slicer. The object is already segmented out and saves as a label. This object has a curvy shape so Ruler tool does not work.<br>
Here are what I already tried:</p>
<ul>
<li>I tried “Extract Skeleton” module with different parameters but it goes on infinite loop. Why I get such behavior? in case it works, how can I compute the length as the output is just number of points that already decided by the user?</li>
<li>I tried “BinaryThinningImageFilter”,  it works and I get a curve from the object. How can I measure this curve length?</li>
</ul>
<p>Thanks!<br>
Ibraheem</p>

---

## Post #2 by @Frederic (2017-12-15 12:16 UTC)

<p>You could use: CurveMaker (since the Extension Manager)<br>
Best.</p>

---

## Post #3 by @Nicole_Aucoin (2017-12-15 15:28 UTC)

<p>Another (less precise) option is that if you place fiducials close together<br>
along the length of a curve, you can get the summed linear distance between<br>
all the highlighted fiducials in the Markups module by right clicking in<br>
the table.</p>
<p>Nicole</p>

---

## Post #4 by @brhoom (2017-12-26 20:02 UTC)

<p>Many thanks for the info. Actually, I am trying to automate things here. Here is what I tried and it works so far.</p>
<p>First I apply “BinaryThinningImageFilter” on the label then I  apply  “Extract Skeleton”.<br>
With this, I get a nice list of points that represent my curve in a text file. What I need to do now is to accumulate the distance between all these points. If there is already a python script for this, I appreciate sharing it. If not, I will try to write it and share it with everyone.<br>
I guess it will be something like (please correct me if I am wrong):</p>
<ul>
<li>P1 = the first point in the text file</li>
<li>P1 =IJK2RAS(P1)</li>
<li>D = 0</li>
<li>for all remaining points p<br>
P2 =    p<br>
P2 =IJK2RAS(P2)<br>
D = D + dist(P1,P2)<br>
P1=P2</li>
</ul>
<p>Thanks!<br>
Ibraheem</p>

---

## Post #5 by @brhoom (2017-12-27 16:13 UTC)

<p>Here is the script:</p>
<pre><code>    import numpy as np
    inputFileName    = "CurveLength.txt"
    print("================= Start Process =====================")             
    # Get GetIJKToRASMatrix from the input volume
    mFid     = self.inputSelector.currentNode() # this is a slicer.qMRMLNodeComboBox()
    mRAS=vtk.vtkMatrix4x4(); 
    mFid.GetIJKToRASMatrix(mRAS)
    Distance = 0   #  curve length in mm
    i= 0                #  counter
    f = open(inputFileName,'r')
    for line in f:       
        i = i + 1 
        lineDig=[int(s) for s in line.split() if s.isdigit()] 
        Pijk = [lineDig[1],lineDig[2],lineDig[3], 1]
        Pras = mRAS.MultiplyDoublePoint(Pijk)
        if (i&gt;1):
           P2x= Pras[0] ; P2y= Pras[1] ; P2z= Pras[2] ;  
           Distance = Distance + np.sqrt((P2x-P1x)**2 +  (P2y-P1y)**2 + (P2z-P1z)**2)                  
           P1x= Pras[0] ; P1y= Pras[1] ; P1z= Pras[2] ;  
        else:
           P1x= Pras[0] ; P1y= Pras[1] ; P1z= Pras[2] ;  
    f.close()
    print(Distance) 
</code></pre>
<p>Still one problem. I get a length different from the one I get manually using the fiducial. Am I missing somethng?</p>

---

## Post #6 by @brhoom (2018-01-10 21:24 UTC)

<p>I found out the points generated by the text files are not all the points generated by the skeleton filter, please check the images. The fiducial points represent the points from the text file. Any suggestion to correct this?</p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="https://us1.discourse-cdn.com/flex002/uploads/slicer/original/3X/a/1/a125f9a8500e709d435ceb43c2fbb7578aff14ef.png" data-download-href="/uploads/short-url/mZAewAO08QSiIOdmNSB3AoyQten.png?dl=1" title="skel01" rel="noopener nofollow ugc"><img src="https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/a/1/a125f9a8500e709d435ceb43c2fbb7578aff14ef_2_683x500.png" alt="skel01" data-base62-sha1="mZAewAO08QSiIOdmNSB3AoyQten" width="683" height="500" srcset="https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/a/1/a125f9a8500e709d435ceb43c2fbb7578aff14ef_2_683x500.png, https://us1.discourse-cdn.com/flex002/uploads/slicer/original/3X/a/1/a125f9a8500e709d435ceb43c2fbb7578aff14ef.png 1.5x, https://us1.discourse-cdn.com/flex002/uploads/slicer/original/3X/a/1/a125f9a8500e709d435ceb43c2fbb7578aff14ef.png 2x" data-dominant-color="9090B2"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">skel01</span><span class="informations">1000×731 57.1 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>

---

## Post #7 by @lassoan (2018-01-11 04:39 UTC)

<p>Have you enabled “Do not prune branches” option in “Extract skeleton” module?</p>

---

## Post #8 by @Hamid (2021-07-04 20:35 UTC)

<p>What does the e.g “0.015 mm-1” in measurement of curvature in Markup? does it mean the redius of curvature is 1000/15  mm?</p>

---

## Post #9 by @lassoan (2021-07-05 18:32 UTC)

<p>The value that Slicer computes is the curvature of a curve. You can look up the exact definition I. Wikipedia, but in short, curvature is 1/R where R is the radius of the circle that best approximates the curve at that point. For a circle that has a radius of 10 mm the curvature of every point is 0.1 and the unit is 1/mm.</p>

---
