# DICOM import problem, related to localizer images

**Topic ID**: 4730
**Date**: 2018-11-12
**URL**: https://discourse.slicer.org/t/dicom-import-problem-related-to-localizer-images/4730

---

## Post #1 by @torquil (2018-11-12 14:07 UTC)

<p>Hi!</p>
<p>I’m having a problem importing DICOM generated by a software system using with a Siemens Artis Pheeno CT machine. I have found out that it works find it I delete the single DICOM image corresponding to the orthogonal image containing localizer lines (see 2.2.1 here: <a href="http://www.dclunie.com/medical-image-faq/html/part2.html" rel="nofollow noopener">http://www.dclunie.com/medical-image-faq/html/part2.html</a>).</p>
<p>The volume in question is covered by 18 images, and there is one additional image containing localizer lines, so a total of 19 images. However, when I select and click “Examine” in the Slicer DICOM import window, it says that there are 19 images, so it doesn’t seem to understand that one of the images are only for localizer lines, and should not be part of the volume. Since the localizer lines image is also placed completely differently than all the other images, Slicer warns that there is a problem:</p>
<p>“Images are not equally spaced (a difference of -35.9005 to 36.4005 in spacings was detected)…”</p>
<p>I have found out that it is always the image with DICOM (0020,0013) attribute InstanceNumber=0 which is the localizer line image, i.e. “scout image”. In addition, the “ImageType” (0008,0008) DICOM attribute contains “LOCALIZER” for the localizer image, so Slicer should be able to ignore it. By deleting that image from the DICOM directory, Slicer will import fine without warnings.</p>
<p>So the question is, can the Slicer DICOM importer detect and ignore these “scout images” by ignore images which have “LOCALIZER” in the (0008,0008) ImageType DICOM attribute?</p>
<p>I’m not able to share any DICOM files with this “problem”. If necessary, I would be happy to delve into the code to analyse what is happening in more detail if that is necessary. I’m using the latest Slicer 3D nightly on Linux.</p>
<p>Here is some DICOM metainfo (I have deleted time/date-info and some other stuff due to paranoia). First from the localizer image and then from a proper image:</p>
<p>Localizer image (InstanceNumber=0):</p>
<pre><code class="lang-auto">[0008,0005]	SpecificCharacterSet	ISO_IR 100	CS	10
[0008,0008]	ImageType	[7] DERIVED, SECONDARY, LOCALIZER, MPR, , , PARALLEL	CS	42
[0008,0060]	Modality	XA	CS	2
[0008,0070]	Manufacturer	Siemens	LO	8
[0008,0080]	InstitutionName		LO	0
[0008,0090]	ReferringPhysicianName		PN	0
[0008,1010]	StationName	anonymous	SH	10
[0008,1030]	StudyDescription	Rtg. Tinningben bilateralt	LO	26
[0008,103e]	SeriesDescription	&lt;MPR Range&gt;	LO	12
[0008,1070]	OperatorsName	anonymous	PN	10
[0008,1090]	ManufacturerModelName	AXIOM-Artis	LO	12
[0008,1250]	RelatedSeriesSequence		SQ	148
	[fffe,e000]	Item		na	132
		[0040,a170]	PurposeOfReferenceCodeSequence		SQ	0
[0010,0021]	IssuerOfPatientID	anonymous	LO	10
[0010,0030]	PatientBirthDate		DA	0
[0010,1005]	PatientBirthName	anonymous	PN	10
[0010,1060]	PatientMotherBirthName	anonymous	PN	10
[0010,2000]	MedicalAlerts	anonymous	LO	10
[0010,2110]	Allergies	anonymous	LO	10
[0010,2150]	CountryOfResidence	anonymous	LO	10
[0010,2152]	RegionOfResidence	anonymous	LO	10
[0010,2154]	PatientTelephoneNumbers	anonymous	SH	10
[0010,21a0]	SmokingStatus	UNKNOWN	CS	8
[0010,21f0]	PatientReligiousPreference	anonymous	LO	10
[0018,0015]	BodyPartExamined	RG Tinningben B	CS	16
[0018,0050]	SliceThickness	0.5	DS	4
[0018,0060]	KVP	89.9	DS	4
[0018,1000]	DeviceSerialNumber	anonymous	LO	10
[0018,1020]	SoftwareVersions	[3] VE10B 180816, VD20C 180516, VA30C.180516_5	LO	40
[0018,1030]	ProtocolName	anonymous	LO	10
[0018,1110]	DistanceSourceToDetector	1300	DS	4
[0018,5100]	PatientPosition	HFS	CS	4
[0020,0011]	SeriesNumber	18	IS	2
[0020,0012]	AcquisitionNumber	18	IS	2
[0020,0013]	InstanceNumber	0	IS	2
[0020,0032]	ImagePositionPatient	[3] -60.20976, -217.752158, -88.503031	DS	32
[0020,0037]	ImageOrientationPatient	[6] 0.5754439915, 0.8123224739, -0.094849413, -0.2837450896, 0.0895280053, -0.9547111921	DS	80
[0020,0052]	FrameOfReferenceUID	1.3.12.2.1107.5.4.5.164089.30000018110714310920800000001	UI	56
[0020,1040]	PositionReferenceIndicator		LO	0
[0028,0002]	SamplesPerPixel	1	US	2
[0028,0004]	PhotometricInterpretation	MONOCHROME2	CS	12
[0028,0010]	Rows	512	US	2
[0028,0011]	Columns	512	US	2
[0028,0030]	PixelSpacing	[2] 0.234193, 0.234193	DS	18
[0028,0100]	BitsAllocated	16	US	2
[0028,0101]	BitsStored	16	US	2
[0028,0102]	HighBit	15	US	2
[0028,0103]	PixelRepresentation	0	US	2
[0028,0106]	SmallestImagePixelValue	0	US	2
[0028,0107]	LargestImagePixelValue	7609	US	2
[0028,0120]	PixelPaddingValue	0	US	2
[0028,1050]	WindowCenter	1726	DS	4
[0028,1051]	WindowWidth	4256	DS	4
[0028,1052]	RescaleIntercept	-1024	DS	6
[0028,1053]	RescaleSlope	1	DS	2
[0028,2110]	LossyImageCompression	00	CS	2
[7fe0,0010]	PixelData	0000	OW	524288
</code></pre>
<p>Ordinary image (InstanceNumber=1):</p>
<pre><code class="lang-auto">[0008,0005]	SpecificCharacterSet	ISO_IR 100	CS	10
[0008,0008]	ImageType	[7] DERIVED, SECONDARY, AXIAL, MPR, , , PARALLEL	CS	38
[0008,0060]	Modality	XA	CS	2
[0008,0070]	Manufacturer	Siemens	LO	8
[0008,0080]	InstitutionName		LO	0
[0008,0090]	ReferringPhysicianName		PN	0
[0008,1010]	StationName	anonymous	SH	10
[0008,1030]	StudyDescription	Rtg. Tinningben bilateralt	LO	26
[0008,103e]	SeriesDescription	&lt;MPR Range&gt;	LO	12
[0008,1070]	OperatorsName	anonymous	PN	10
[0008,1090]	ManufacturerModelName	AXIOM-Artis	LO	12
[0008,1250]	RelatedSeriesSequence		SQ	148
	[fffe,e000]	Item		na	132
		[0040,a170]	PurposeOfReferenceCodeSequence		SQ	0
[0010,0021]	IssuerOfPatientID	anonymous	LO	10
[0010,0030]	PatientBirthDate		DA	0
[0010,1005]	PatientBirthName	anonymous	PN	10
[0010,1060]	PatientMotherBirthName	anonymous	PN	10
[0010,2000]	MedicalAlerts	anonymous	LO	10
[0010,2110]	Allergies	anonymous	LO	10
[0010,2150]	CountryOfResidence	anonymous	LO	10
[0010,2152]	RegionOfResidence	anonymous	LO	10
[0010,2154]	PatientTelephoneNumbers	anonymous	SH	10
[0010,21a0]	SmokingStatus	UNKNOWN	CS	8
[0010,21f0]	PatientReligiousPreference	anonymous	LO	10
[0018,0015]	BodyPartExamined	RG Tinningben B	CS	16
[0018,0050]	SliceThickness	0.5	DS	4
[0018,0060]	KVP	89.9	DS	4
[0018,1000]	DeviceSerialNumber	anonymous	LO	10
[0018,1020]	SoftwareVersions	[3] VE10B 180816, VD20C 180516, VA30C.180516_5	LO	40
[0018,1030]	ProtocolName	anonymous	LO	10
[0018,1110]	DistanceSourceToDetector	1300	DS	4
[0018,5100]	PatientPosition	HFS	CS	4
[0020,0011]	SeriesNumber	18	IS	2
[0020,0012]	AcquisitionNumber	18	IS	2
[0020,0013]	InstanceNumber	1	IS	2
[0020,0032]	ImagePositionPatient	[3] -81.65774, -149.32479, -84.70925	DS	30
[0020,0037]	ImageOrientationPatient	[6] 0.7670421615, -0.5762953767, -0.2820105693, -0.0437479014, 0.3915436291, -0.9191189845	DS	82
[0020,0052]	FrameOfReferenceUID	1.3.12.2.1107.5.4.5.164089.30000018110714310920800000001	UI	56
[0020,1040]	PositionReferenceIndicator		LO	0
[0028,0002]	SamplesPerPixel	1	US	2
[0028,0004]	PhotometricInterpretation	MONOCHROME2	CS	12
[0028,0010]	Rows	512	US	2
[0028,0011]	Columns	512	US	2
[0028,0030]	PixelSpacing	[2] 0.222484, 0.222484	DS	18
[0028,0100]	BitsAllocated	16	US	2
[0028,0101]	BitsStored	16	US	2
[0028,0102]	HighBit	15	US	2
[0028,0103]	PixelRepresentation	0	US	2
[0028,0106]	SmallestImagePixelValue	0	US	2
[0028,0107]	LargestImagePixelValue	5381	US	2
[0028,0120]	PixelPaddingValue	0	US	2
[0028,1050]	WindowCenter	1726	DS	4
[0028,1051]	WindowWidth	4256	DS	4
[0028,1052]	RescaleIntercept	-1024	DS	6
[0028,1053]	RescaleSlope	1	DS	2
[0028,2110]	LossyImageCompression	00	CS	2
[7fe0,0010]	PixelData	0000	OW	524288
</code></pre>
<p>Best regards,<br>
Torquil Sørensen</p>

---

## Post #2 by @lassoan (2018-11-12 14:36 UTC)

<p>Scout image should have a different DICOM series instance UID. If you haven’t modified the images (tried to anonymize, etc) then this is most likely an error in GE’s software. Report this to them and they should fix it. Maybe they have already fixed this and you just need to upgrade your software.</p>
<p>In the meantime, the easiest is if you remove the scout image.</p>

---

## Post #3 by @torquil (2018-11-13 07:56 UTC)

<p>I haven’t modified the files. They are anonymized output generated by the radiographer. I will ask her to put me into contact with the support people from Siemens so I can ask them about the DICOM attributes.</p>
<p>If this really is dictated clearly by the DICOM standard, do you have a reference for this that I can provide to them?</p>
<p>When you say “DICOM series instance UID should be different”, do you mean the DICOM attribute (0020,000e)? There seems to be two of those in the DICOM metainfo reported by Slicer, one nested under “RelatedSeriesSequence” and one that is not, and these is are identical for the scout image and the others:</p>
<pre><code>[0008,1250]	RelatedSeriesSequence		SQ	148
    [fffe,e000]	Item		na	132
	[0020,000e]	SeriesInstanceUID 1.3.12.2.1107.5.4.5.164089.30000018110606430919200000598	UI	56
[0020,000e]	SeriesInstanceUID	1.3.12.2.1107.5.4.5.164089.30000018110714310920800000000	UI	56
</code></pre>
<p>Best regards,<br>
Torquil</p>

---

## Post #4 by @lassoan (2018-11-15 01:41 UTC)

<p>You can ignore the series instance UID in the RelatedSeriesSequence sequence (that just tells which series are related). Scout image and other should not have the same SeriesInstanceUID value (1.3.12.2.1107.5.4.5.164089.30000018110714310920800000000).</p>
<p>DICOM does not strictly specify how to organize series. According to the <a href="http://dicom.nema.org/medical/dicom/current/output/html/part03.html#sect_A.1.2.3">DICOM standard</a> “Each Series may be associated with exactly one Frame of Reference IE, and if so associated all Composite Instances within the Series shall be spatially or temporally related to each other”. Definition of “related” is quite open, so it is permitted to store localizer images and axial frames in the same series, it is just very uncommon and should be avoided (because it would force implementing complicated mechanisms in all software that wants to use the data).</p>

---

## Post #5 by @lassoan (2019-11-11 15:43 UTC)

<p>FYI, in latest Slicer Preview Release <a href="https://discourse.slicer.org/t/problems-during-dicom-import/9060/30">we have now implemented split of series based on image type DICOM attribute value</a>. If you enable Advanced view in DICOM browser, click Examine, then in the loadable list you can choose to load the localizer or the 3D volume.</p>

---
