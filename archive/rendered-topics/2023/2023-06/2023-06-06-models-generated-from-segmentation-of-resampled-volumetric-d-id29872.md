---
topic_id: 29872
title: "Models Generated From Segmentation Of Resampled Volumetric D"
date: 2023-06-06
url: https://discourse.slicer.org/t/29872
---

# Models generated from segmentation of "resampled" volumetric data do not seem to inherit the parent data's transform

**Topic ID**: 29872
**Date**: 2023-06-06
**URL**: https://discourse.slicer.org/t/models-generated-from-segmentation-of-resampled-volumetric-data-do-not-seem-to-inherit-the-parent-datas-transform/29872

---

## Post #1 by @jgrime (2023-06-06 19:03 UTC)

<p>Operating system: Windows 10 Enterprise<br>
Slicer version: 5.2.2</p>
<p>Expected behavior: Polygonal mesh data generated by segmentation/model generation of resampled volumetric data should have the same transform as the “parent” data</p>
<p>Actual behavior: The polygonal mesh data (.stl or .obj) generated/exported does not overlay the “source data”</p>
<p>I’m registering a collection of data that should overlap in space. The registration seems to work fine, and so I then resampled the registered data to generate new volumetric data that should share a common (overlapping) region in space.</p>
<p>When I visualize the resultant .nrrd files in ParaView they do indeed overlap in space. Great!</p>
<p>However, when I segment/model the resampled data in Slicer to generate polygon meshes, these meshes do not seem to inherit the same coordinate system; they do not overlap the source data when viewed in ParaView!</p>
<p>How do I make sure the polygon mesh data generated by segmentation/model generation of the resampled volumetric data actually inherits vertex positions that are commensurate with the resampled data? I would assume the vertex positions would be automatically transformed by whatever underlying transform is present in the volumetric data that was used to generate that model?</p>
<p>Thanks!</p>
<p>J.</p>

---

## Post #2 by @lassoan (2023-06-16 16:59 UTC)

<p>ParaView only shows 3D volumes in correct location in special cases (when IJK axes of the volumes have the same direction as LPS axes), so you cannot verify alignment of images and models in ParaView. The only software other than Slicer that quickly comes to mind that can load meshes and 3D volumes corectly is MITK.</p>
<p>If you have a model under a transform then saving the model will not apply the parent transform, because when you save a node you want that data saved, not some modified version of it. To get the transformed model into a file you can either:</p>
<ul>
<li>A. Harden the transform on the model before saving</li>
<li>B. Do not <em>save</em> the model but <em>export</em> the transformed model: in Data module you can right-click on the node you want to export. choose “Export to file…” and check “Apply transforms”</li>
</ul>

---

## Post #3 by @jgrime (2023-06-16 18:24 UTC)

<p>Hi Andras,</p>
<p>Thanks for the help!</p>
<p>Unfortunately, I have tried hardening the transforms to no avail.</p>
<p>I’ve also looked for the “Apply Transforms” option in “Export to file…” and the “Apply Transforms” option doesn’t seem to be present for any of the available export file formats. I went down the list selecting all of them and looking for an “Apply Transforms” option and none appeared. The only export option seemed to be “Compress” (see example screenshot below).</p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="https://us1.discourse-cdn.com/flex002/uploads/slicer/original/3X/e/9/e9e97d051fcb291dc233dea4a8c62d0e897aadec.png" data-download-href="/uploads/short-url/xnhuOV2UGKMCrS2RnpU2GsuOX6Y.png?dl=1" title="Capture" rel="noopener nofollow ugc"><img src="https://us1.discourse-cdn.com/flex002/uploads/slicer/original/3X/e/9/e9e97d051fcb291dc233dea4a8c62d0e897aadec.png" alt="Capture" data-base62-sha1="xnhuOV2UGKMCrS2RnpU2GsuOX6Y" width="690" height="291" data-dominant-color="EFF1F3"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">Capture</span><span class="informations">902×381 13.5 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<p>Can I simply create an empty volume via an axis-aligned region of interest? Presumably that would have a transform basically equivalent to the identity matrix, and then if I resample data via “Registration → Resample Image (BRAINS)” using that empty volume as the “Reference Image” I should end up with voxel data that’s all axis aligned and doesn’t then require any external software to understand any transform that needs to be applied to the data?</p>
<p>The only result I can find from a Google search regarding creation of an empty volume is this (using the “Image Maker” CLI extension):</p>
<p><a href="https://slicer.readthedocs.io/en/latest/developer_guide/script_repository/volumes.html" class="onebox" target="_blank" rel="noopener nofollow ugc">https://slicer.readthedocs.io/en/latest/developer_guide/script_repository/volumes.html</a></p>
<p>… which I’d rather not do because I’m trying to keep this GUI based for future reference by other users.</p>
<p>There’s also this post from yourself back in 2018:</p>
<aside class="quote quote-modified" data-post="2" data-topic="4889">
  <div class="title">
    <div class="quote-controls"></div>
    <img loading="lazy" alt="" width="24" height="24" src="https://sea2.discourse-cdn.com/flex020/user_avatar/discourse.slicer.org/lassoan/48/13_2.png" class="avatar">
    <a href="https://discourse.slicer.org/t/create-a-volume/4889/2">Create a volume</a> <a class="badge-category__wrapper " href="/c/support/11"><span data-category-id="11" data-drop-close="true" class="badge-category " title="The Support category is for all usage questions and general discussion of Slicer and extensions."><span class="badge-category__name">Support</span></span></a>
  </div>
  <blockquote>
    You can do this with the Segment Editor module. 
Add a region of interest (ROI) widget that covers the area where the volume will be (on the toolbar, click down-arrow of the place icon then click in the center of the region and at a corner) and set the desired voxel size: 
[image] 
After this, unfortunately, you need to choose a volume as Master volume, because several effects of SegmentEditor requires presence of a master volume. It can be any volume, for example you can download MRHead image u…
  </blockquote>
</aside>

<p>… but I’m not sure if that’s still valid. You did mention “<span class="bbcode-i">We’ll figure out some way to not require this step (maybe create a blank volume), but right now you need to do this</span>” and it seems you still need to do this five years later?</p>
<p>Do I have to create a suitable empty volume data set in e.g. FIJI and then load it into Slicer?</p>

---

## Post #4 by @lassoan (2023-06-16 18:41 UTC)

<p>“Apply transform” option only appears if the node is under a transform.</p>
<p>If you hardened the transform (or exported with “apply transform” option) then it is all good, everything is in correct (LPS) coordinate system. You can confirm it by loading the data sets into Slicer or MITK. If you share your scene (upload somewhere and post the link here) then we can have a look, but based on what you described everything should be good.</p>
<p>Maybe the only thing that confuses you is that ParaView shows the volume in incorrect position. ParaView is great software for mesh visualization but 3D image and transforms support has serious limitations and bugs that have not been fixed for many years, so probably funding sources of ParaView are just not that interested these. If you work with 3D images then I would not recommend to rely too much on ParaView.</p>

---

## Post #5 by @jgrime (2023-06-19 15:07 UTC)

<p>Thanks, Andras!</p>
<p>The animation tools in ParaView are quite useful for us at the moment, hence the use of that software. The animation facility in Slicer is promising, but seems to lack some functionality I’d need.</p>
<p>Would my thoughts regarding resampling data in Slicer with an empty reference volume (presumably with the identity matrix as the local transform) help to address this issue?</p>

---
