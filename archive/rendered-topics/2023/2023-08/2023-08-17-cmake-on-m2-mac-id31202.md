# Cmake on m2 mac

**Topic ID**: 31202
**Date**: 2023-08-17
**URL**: https://discourse.slicer.org/t/cmake-on-m2-mac/31202

---

## Post #1 by @Kening_Zhang (2023-08-17 19:48 UTC)

<p><div class="lightbox-wrapper"><a class="lightbox" href="https://us1.discourse-cdn.com/flex002/uploads/slicer/original/3X/4/4/44d35f2168126a988c0142460d64e5086eaa770a.png" data-download-href="/uploads/short-url/9ORkqPXpJgR48U8DHJ7PH2XtiRA.png?dl=1" title="image" rel="noopener nofollow ugc"><img src="https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/4/4/44d35f2168126a988c0142460d64e5086eaa770a_2_646x500.png" alt="image" data-base62-sha1="9ORkqPXpJgR48U8DHJ7PH2XtiRA" width="646" height="500" srcset="https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/4/4/44d35f2168126a988c0142460d64e5086eaa770a_2_646x500.png, https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/4/4/44d35f2168126a988c0142460d64e5086eaa770a_2_969x750.png 1.5x, https://us1.discourse-cdn.com/flex002/uploads/slicer/original/3X/4/4/44d35f2168126a988c0142460d64e5086eaa770a.png 2x" data-dominant-color="F9F0EE"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">image</span><span class="informations">1132×876 191 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div><br>
When I try<br>
<div class="lightbox-wrapper"><a class="lightbox" href="https://us1.discourse-cdn.com/flex002/uploads/slicer/original/3X/8/f/8f7ac5872f656c4d825c2814eec9f0313bc389dc.png" data-download-href="/uploads/short-url/kthjxDhT4Q4u1NkOL1FFBhmvCy0.png?dl=1" title="image" rel="noopener nofollow ugc"><img src="https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/8/f/8f7ac5872f656c4d825c2814eec9f0313bc389dc_2_690x159.png" alt="image" data-base62-sha1="kthjxDhT4Q4u1NkOL1FFBhmvCy0" width="690" height="159" srcset="https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/8/f/8f7ac5872f656c4d825c2814eec9f0313bc389dc_2_690x159.png, https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/8/f/8f7ac5872f656c4d825c2814eec9f0313bc389dc_2_1035x238.png 1.5x, https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/8/f/8f7ac5872f656c4d825c2814eec9f0313bc389dc_2_1380x318.png 2x" data-dominant-color="F3F5E8"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">image</span><span class="informations">1748×404 31.2 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div><br>
Error happens, how should I solve it?<br>
Best wishes,<br>
Joshua</p>

---

## Post #2 by @jamesobutler (2023-08-17 19:58 UTC)

<p>Take a look at the following Slicer GitHub issue about the current workarounds and when native Apple Silicon support will be added.</p>
<aside class="onebox githubissue" data-onebox-src="https://github.com/Slicer/Slicer/issues/5944#issuecomment-1328179343">
  <header class="source">

      <a href="https://github.com/Slicer/Slicer/issues/5944#issuecomment-1328179343" target="_blank" rel="noopener nofollow ugc">github.com/Slicer/Slicer</a>
  </header>

  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Issue">
	  <svg width="60" height="60" class="github-icon" viewBox="0 0 14 16" aria-hidden="true"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="https://github.com/Slicer/Slicer/issues/5944#issuecomment-1328179343" target="_blank" rel="noopener nofollow ugc">Unable to build from source on Apple silicon</a>
    </h4>

    <div class="github-info">
      <div class="date">
        opened <span class="discourse-local-date" data-format="ll" data-date="2021-10-12" data-time="17:46:43" data-timezone="UTC">05:46PM - 12 Oct 21 UTC</span>
      </div>


      <div class="user">
        <a href="https://github.com/kliron" target="_blank" rel="noopener nofollow ugc">
          <img alt="kliron" src="https://avatars.githubusercontent.com/u/626811?v=4" class="onebox-avatar-inline" width="20" height="20">
          kliron
        </a>
      </div>
    </div>

    <div class="labels">
        <span style="display:inline-block;margin-top:2px;background-color: #B8B8B8;padding: 2px;border-radius: 4px;color: #fff;margin-left: 3px;">
          type:bug
        </span>
        <span style="display:inline-block;margin-top:2px;background-color: #B8B8B8;padding: 2px;border-radius: 4px;color: #fff;margin-left: 3px;">
          domain:build-system
        </span>
    </div>
  </div>
</div>

  <div class="github-row">
    <p class="github-body-container">## Steps to reproduce

I followed all the instructions from the [docs](https:/<span class="show-more-container"><a href="" rel="noopener" class="show-more">…</a></span><span class="excerpt hidden">/slicer.readthedocs.io/en/latest/developer_guide/build_instructions/macos.html#prerequisites) to build slicer from source. 

Build halts with the following error while trying to build DCMTK:

```
make[2]: *** [DCMTK-prefix/src/DCMTK-stamp/DCMTK-configure] Error 1
make[1]: *** [CMakeFiles/DCMTK.dir/all] Error 2
-- OpenSSL: Errors detected - See below.

ld: warning: double slash removed from -install_name (/Users/kliron/opt/slicer/OpenSSL//libcrypto.1.1.dylib)
ld: warning: The i386 architecture is deprecated for macOS (remove from the Xcode build setting: ARCHS)
ld: warning: ignoring file /Users/kliron/opt/slicer/zlib-install/lib/libz.a, building for macOS-i386 but attempting to link with file built for macOS-arm64
ld: warning: ignoring file /Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX11.3.sdk/usr/lib/libSystem.tbd, missing required architecture i386 in file /Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX11.3.sdk/usr/lib/libSystem.tbd (3 slices)

Undefined symbols for architecture i386:

"__DefaultRuneLocale", referenced from:
      _CONF_parse_list in conf_mod.o
  "___bzero", referenced from:
      _ASN1_BIT_STRING_set_bit in a_bitstr.o
      _asn1_item_embed_new in tasn_new.o
      _addr_strings in b_addr.o
      _mem_ctrl in bss_mem.o
      _BLAKE2b_Final in blake2b.o
      _BLAKE2s_Final in blake2s.o
      _bn_div_fixed_top in bn_div.o
      ...

[...an extensive output of a lot more missing symbols...]

ld: symbol(s) not found for architecture i386
clang: error: linker command failed with exit code 1 (use -v to see invocation)
make[4]: *** [libcrypto.dylib] Error 1
make[3]: *** [build_libs] Error 2

CMake Error at /Users/kliron/Projects/slicer/CMake/ExternalProjectForNonCMakeProject.cmake:104 (message):
  OpenSSL: build step failed with exit code '2'.
```

## Expected behavior

A successful build.

## Environment
- Slicer version: latest source tree
- Operating system: MacOS Big Sur 11.6

Has anyone been able to compile slicer from source on a M1 Mac? How do I bypass the missing i386 openssl library?</span></p>
  </div>

  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>


---
