# Wrong number of cells in Model Maker model

**Topic ID**: 29282
**Date**: 2023-05-04
**URL**: https://discourse.slicer.org/t/wrong-number-of-cells-in-model-maker-model/29282

---

## Post #1 by @benzwick (2023-05-04 06:33 UTC)

<p>I’m having some trouble using the Model Maker module. I’m trying to create a surface model from a binary labelmap mask of a brain (see screenshot01). It appears to work correctly but when I check the number of cells in the Model module (screenshot02) it is different to the debugging output of Model Maker (screenshot01). Moreover, if I save and reload the same model in STL format I get the correct number of cells (see screenshot04). This is not the case if I save and reload using VTK format (see screenshot03).</p>
<p>Can anyone explain what might be happening here?</p>
<p>I need to use the model generated by Model Maker as the input to another module that we are developing (<a href="https://github.com/SlicerCBM/SlicerCBM/tree/master/SurfaceTriangulation" class="inline-onebox" rel="noopener nofollow ugc">SlicerCBM/SurfaceTriangulation at master · SlicerCBM/SlicerCBM · GitHub</a>). Our module fails if the model is used directly (probably has something to do with converting VTK to PyVista mesh data type) but if the model is saved first as STL and reloaded everything works as expected.</p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="https://us1.discourse-cdn.com/flex002/uploads/slicer/original/3X/1/2/1296aa15d1a0640d696b43fc7c23c3685ea4a51f.png" data-download-href="/uploads/short-url/2ErogIFZy6X2fB4u3zNRpjqPx0P.png?dl=1" title="screenshot01" rel="noopener nofollow ugc"><img src="https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/1/2/1296aa15d1a0640d696b43fc7c23c3685ea4a51f_2_690x432.png" alt="screenshot01" data-base62-sha1="2ErogIFZy6X2fB4u3zNRpjqPx0P" width="690" height="432" srcset="https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/1/2/1296aa15d1a0640d696b43fc7c23c3685ea4a51f_2_690x432.png, https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/1/2/1296aa15d1a0640d696b43fc7c23c3685ea4a51f_2_1035x648.png 1.5x, https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/1/2/1296aa15d1a0640d696b43fc7c23c3685ea4a51f_2_1380x864.png 2x" data-dominant-color="898F8F"><div class="meta">
<svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">screenshot01</span><span class="informations">2050×1286 295 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg>
</div></a></div><br>
<div class="lightbox-wrapper"><a class="lightbox" href="https://us1.discourse-cdn.com/flex002/uploads/slicer/original/3X/f/f/ffba2e066d2106b487576fc1d8fe416aeeeac044.png" data-download-href="/uploads/short-url/AugDSU4G0WxRbnKkN1UNlfB6RuI.png?dl=1" title="screenshot02" rel="noopener nofollow ugc"><img src="https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/f/f/ffba2e066d2106b487576fc1d8fe416aeeeac044_2_690x432.png" alt="screenshot02" data-base62-sha1="AugDSU4G0WxRbnKkN1UNlfB6RuI" width="690" height="432" srcset="https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/f/f/ffba2e066d2106b487576fc1d8fe416aeeeac044_2_690x432.png, https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/f/f/ffba2e066d2106b487576fc1d8fe416aeeeac044_2_1035x648.png 1.5x, https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/f/f/ffba2e066d2106b487576fc1d8fe416aeeeac044_2_1380x864.png 2x" data-dominant-color="898F8E"><div class="meta">
<svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">screenshot02</span><span class="informations">2050×1286 254 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg>
</div></a></div><br>
<div class="lightbox-wrapper"><a class="lightbox" href="https://us1.discourse-cdn.com/flex002/uploads/slicer/original/3X/9/9/99e7d4f8b0adce4a63a01e981ef54eb26d3cdd86.png" data-download-href="/uploads/short-url/lXvKxdghM6ZaEdZw7bNEUZKjmHs.png?dl=1" title="screenshot03" rel="noopener nofollow ugc"><img src="https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/9/9/99e7d4f8b0adce4a63a01e981ef54eb26d3cdd86_2_690x432.png" alt="screenshot03" data-base62-sha1="lXvKxdghM6ZaEdZw7bNEUZKjmHs" width="690" height="432" srcset="https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/9/9/99e7d4f8b0adce4a63a01e981ef54eb26d3cdd86_2_690x432.png, https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/9/9/99e7d4f8b0adce4a63a01e981ef54eb26d3cdd86_2_1035x648.png 1.5x, https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/9/9/99e7d4f8b0adce4a63a01e981ef54eb26d3cdd86_2_1380x864.png 2x" data-dominant-color="8B908D"><div class="meta">
<svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">screenshot03</span><span class="informations">2050×1286 268 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg>
</div></a></div><br>
<div class="lightbox-wrapper"><a class="lightbox" href="https://us1.discourse-cdn.com/flex002/uploads/slicer/original/3X/0/5/05b35b254d88730431f5afe342327a8fa286d1f6.png" data-download-href="/uploads/short-url/OqEFfguPAsYk8QfJwqkDaX0Zo2.png?dl=1" title="screenshot04" rel="noopener nofollow ugc"><img src="https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/0/5/05b35b254d88730431f5afe342327a8fa286d1f6_2_690x432.png" alt="screenshot04" data-base62-sha1="OqEFfguPAsYk8QfJwqkDaX0Zo2" width="690" height="432" srcset="https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/0/5/05b35b254d88730431f5afe342327a8fa286d1f6_2_690x432.png, https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/0/5/05b35b254d88730431f5afe342327a8fa286d1f6_2_1035x648.png 1.5x, https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/0/5/05b35b254d88730431f5afe342327a8fa286d1f6_2_1380x864.png 2x" data-dominant-color="8B908D"><div class="meta">
<svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">screenshot04</span><span class="informations">2050×1286 268 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg>
</div></a></div></p>

---

## Post #2 by @benzwick (2023-05-06 02:19 UTC)

<p>It appears to me that this might be a bug in 3D Slicer. The model generated by Model Maker has 146930 triangles, but in the Models module, the number of cells is shown as 21879. If I save and reload the model using the default VTK format, the Models module still shows the number of cells as 21879. However, If I save and reload the same model using STL format, the Models module shows the correct number of 146930 cells. The number of points from both files is the same. Can anyone confirm this behavior?</p>

---

## Post #3 by @muratmaga (2023-05-06 03:46 UTC)

<p>İs there any reason you are not using the segmentations module to do this?</p>

---

## Post #4 by @lassoan (2023-05-06 17:00 UTC)

<p>The triangles and their points are merged or duplicated as needed, so it is normal that their numbers change. For example, when you compute surface normals then you may want to merge some points but to preserve sharp edges you need to duplicate points. STL is a very limited file format, it can only store individual triangles, so when you save into this format then your mesh may need to be converted to an all-triangle mesh.</p>
<p>Recommendations:</p>
<ul>
<li>If you want to save data without changes then you need to use a more capable format than STL. VTK and VTP can store a VTK mesh without any modifications and including point and cell arrays, such as surface normals.</li>
<li>Use Segmentations module for converting between labelmaps and models. It has many advantages over the legacy Model maker module.</li>
</ul>
<p>Note that you do not need to add a new module for ACVD triangulation. Uniform remeshing by ACVD is already available in Slicer core in Surface Toolbox module:</p>
<aside class="quote quote-modified" data-post="1" data-topic="26196">
  <div class="title">
    <div class="quote-controls"></div>
    <img loading="lazy" alt="" width="24" height="24" src="https://sea2.discourse-cdn.com/flex020/user_avatar/discourse.slicer.org/lassoan/48/13_2.png" class="avatar">
    <a href="https://discourse.slicer.org/t/new-feature-uniform-remeshing-acvd-algorithm/26196">New feature: Uniform remeshing (ACVD algorithm)</a> <a class="badge-category__wrapper " href="/c/support/11"><span data-category-id="11" data-drop-close="true" class="badge-category " title="The Support category is for all usage questions and general discussion of Slicer and extensions."><span class="badge-category__name">Support</span></span></a>
  </div>
  <blockquote>
    Models (surface meshes) exported from image segmentation often have very high point counts, which can make visualization and further editing in external software difficult. 
Surface Toolbox module’s Decimate feature has been offering mesh simplification using quadric decimation and decimate pro algorithms, but these algorithms generate highly varying triangle sizes and shapes (depending on the curvature of the region), which is not ideal for some applications. 
We added a new Uniform remesh opti…
  </blockquote>
</aside>


---

## Post #5 by @benzwick (2023-05-07 08:53 UTC)

<aside class="quote no-group" data-username="lassoan" data-post="4" data-topic="29282">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="24" height="24" src="https://sea2.discourse-cdn.com/flex020/user_avatar/discourse.slicer.org/lassoan/48/13_2.png" class="avatar"> lassoan:</div>
<blockquote>
<p>Note that you do not need to add a new module for ACVD triangulation. Uniform remeshing by ACVD is already available in Slicer core in Surface Toolbox module:</p>
</blockquote>
</aside>
<p>I agree, we developed the module before ACVD remeshing was added to Slicer. However, if I try to use the model produced by Model Maker directly or by saving and reloading as VTK format I get this error:</p>
<pre><code class="lang-auto">[Python] Failed to compute output model: Clean tolerance is too high. Empty mesh returned.
Traceback (most recent call last):
  File "/opt/slicer/Slicer-5.2.2-linux-amd64/bin/../lib/Slicer-5.2/qt-scripted-modules/SurfaceToolbox.py", line 278, in onApplyButton
    self.logic.applyFilters(self._parameterNode)
  File "/opt/slicer/Slicer-5.2.2-linux-amd64/bin/../lib/Slicer-5.2/qt-scripted-modules/SurfaceToolbox.py", line 576, in applyFilters
    SurfaceToolboxLogic.remesh(outputModel, outputModel,
  File "/opt/slicer/Slicer-5.2.2-linux-amd64/bin/../lib/Slicer-5.2/qt-scripted-modules/SurfaceToolbox.py", line 412, in remesh
    clus.subdivide(subdivide)
  File "/opt/slicer/Slicer-5.2.2-linux-amd64/lib/Python/lib/python3.9/site-packages/pyacvd/clustering.py", line 80, in subdivide
    self.mesh.copy_from(_subdivide(self.mesh, nsub))
  File "/opt/slicer/Slicer-5.2.2-linux-amd64/lib/Python/lib/python3.9/site-packages/pyacvd/clustering.py", line 354, in _subdivide
    sub_mesh.clean(inplace=True)
  File "/opt/slicer/Slicer-5.2.2-linux-amd64/lib/Python/lib/python3.9/site-packages/pyvista/core/filters/poly_data.py", line 1847, in clean
    raise ValueError('Clean tolerance is too high. Empty mesh returned.')
ValueError: Clean tolerance is too high. Empty mesh returned.
</code></pre>
<p>If I change some of the parameters I get a result that looks like this:<br>
<div class="lightbox-wrapper"><a class="lightbox" href="https://us1.discourse-cdn.com/flex002/uploads/slicer/original/3X/c/7/c77085f47da5bee95493df10bc599f49ce539411.png" data-download-href="/uploads/short-url/ssk5Zjypdo9N5Maf6c9RCvLUHkZ.png?dl=1" title="screenshot05" rel="noopener nofollow ugc"><img src="https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/c/7/c77085f47da5bee95493df10bc599f49ce539411_2_690x392.png" alt="screenshot05" data-base62-sha1="ssk5Zjypdo9N5Maf6c9RCvLUHkZ" width="690" height="392" srcset="https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/c/7/c77085f47da5bee95493df10bc599f49ce539411_2_690x392.png, https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/c/7/c77085f47da5bee95493df10bc599f49ce539411_2_1035x588.png 1.5x, https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/c/7/c77085f47da5bee95493df10bc599f49ce539411_2_1380x784.png 2x" data-dominant-color="B7B8DA"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">screenshot05</span><span class="informations">2050×1166 185 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<p>However, it works if I save and reload the model as STL format before remeshing:<br>
<div class="lightbox-wrapper"><a class="lightbox" href="https://us1.discourse-cdn.com/flex002/uploads/slicer/original/3X/4/d/4d6b4d6c75f500b2d70ed14e8ab9404eb3495815.png" data-download-href="/uploads/short-url/b2SETDeHUaETtHiU1eslt8pA1k9.png?dl=1" title="screenshot06" rel="noopener nofollow ugc"><img src="https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/4/d/4d6b4d6c75f500b2d70ed14e8ab9404eb3495815_2_690x392.png" alt="screenshot06" data-base62-sha1="b2SETDeHUaETtHiU1eslt8pA1k9" width="690" height="392" srcset="https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/4/d/4d6b4d6c75f500b2d70ed14e8ab9404eb3495815_2_690x392.png, https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/4/d/4d6b4d6c75f500b2d70ed14e8ab9404eb3495815_2_1035x588.png 1.5x, https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/4/d/4d6b4d6c75f500b2d70ed14e8ab9404eb3495815_2_1380x784.png 2x" data-dominant-color="BBBBC3"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">screenshot06</span><span class="informations">2050×1166 255 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<aside class="quote no-group" data-username="muratmaga" data-post="3" data-topic="29282" data-full="true">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="24" height="24" src="https://sea2.discourse-cdn.com/flex020/user_avatar/discourse.slicer.org/muratmaga/48/3622_2.png" class="avatar"> muratmaga:</div>
<blockquote>
<p>İs there any reason you are not using the segmentations module to do this?</p>
</blockquote>
</aside>
<p>I don’t remember why we used Model Maker instead of the Segmentations module. I think it was because some of the parameters, such as the amount of smoothing, could be adjusted.</p>
<aside class="quote no-group" data-username="lassoan" data-post="4" data-topic="29282">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="24" height="24" src="https://sea2.discourse-cdn.com/flex020/user_avatar/discourse.slicer.org/lassoan/48/13_2.png" class="avatar"> lassoan:</div>
<blockquote>
<p>Use Segmentations module for converting between labelmaps and models. It has many advantages over the legacy Model maker module.</p>
</blockquote>
</aside>
<p>Thank you, we will try using this instead. What are the main advantages of using the Segmentations module? It is not clear to me from the documentation why Model Maker should not be used. I looks like it has more features/options than the export to model function in the Segmentations model:</p>
<p><a href="https://slicer.readthedocs.io/en/latest/user_guide/modules/modelmaker.html" class="onebox" target="_blank" rel="noopener nofollow ugc">https://slicer.readthedocs.io/en/latest/user_guide/modules/modelmaker.html</a></p>

---

## Post #6 by @muratmaga (2023-05-07 16:17 UTC)

<aside class="quote no-group" data-username="benzwick" data-post="5" data-topic="29282">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="https://sea2.discourse-cdn.com/flex002/user_avatar/discourse.slicer.org/benzwick/48/80521_2.png" class="avatar"> benzwick:</div>
<blockquote>
<p>I don’t remember why we used Model Maker instead of the Segmentations module. I think it was because some of the parameters, such as the amount of smoothing, could be adjusted.</p>
</blockquote>
</aside>
<p>All of those are also adjustable in Segmentations module. The main benefit is that the model you see in 3D viewer will be the model you will be getting out of it too. The workflow typically is import your labelmap as segmentation, adjust in the segment editor -if necessary-, and export it as a 3D model.</p>

---

## Post #7 by @benzwick (2023-05-08 06:59 UTC)

<aside class="quote no-group" data-username="muratmaga" data-post="6" data-topic="29282">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="24" height="24" src="https://sea2.discourse-cdn.com/flex020/user_avatar/discourse.slicer.org/muratmaga/48/3622_2.png" class="avatar"> muratmaga:</div>
<blockquote>
<p>All of those are also adjustable in Segmentations module.</p>
</blockquote>
</aside>
<p>Is this documented anywhere? All I could find for the Segmentations module is this:<br>
<a href="https://slicer.readthedocs.io/en/latest/user_guide/modules/segmentations.html#export-segmentation-to-model-surface-mesh-file" class="onebox" target="_blank" rel="noopener nofollow ugc">https://slicer.readthedocs.io/en/latest/user_guide/modules/segmentations.html#export-segmentation-to-model-surface-mesh-file</a><br>
which doesn’t have any of the parameters available in Model Maker:<br>
<a href="https://slicer.readthedocs.io/en/latest/user_guide/modules/modelmaker.html#model-maker-parameters-parameters-used-for-making-models" class="onebox" target="_blank" rel="noopener nofollow ugc">https://slicer.readthedocs.io/en/latest/user_guide/modules/modelmaker.html#model-maker-parameters-parameters-used-for-making-models</a></p>

---

## Post #8 by @benzwick (2023-05-08 07:10 UTC)

<aside class="quote no-group" data-username="lassoan" data-post="4" data-topic="29282">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="24" height="24" src="https://sea2.discourse-cdn.com/flex020/user_avatar/discourse.slicer.org/lassoan/48/13_2.png" class="avatar"> lassoan:</div>
<blockquote>
<p>The triangles and their points are merged or duplicated as needed, so it is normal that their numbers change.</p>
</blockquote>
</aside>
<p>I don’t think it is normal in this case. To me it looks like a bug in Model Maker. If I load both the VTK and STL files in ParaView both have 73,485 points and both surfaces look identical. However, the VTK mesh has 21,879 cells (wrong), whereas the STL mesh has 146,930 cells (same as the number of cells output in Model Maker debug window).</p>
<p>Looking at the original VTK file it has 21,879 TRIANGLE_STRIPS. If I save as STL and then save the STL file as VTK using Slicer I get a VTK file with 146,930 POLYGONS. Using the Segmentations module instead of Model Maker I get a similar VTK file with 73,486 points and 146,932 POLYGONS.</p>
<p>It appears that PyACVD cannot remesh the file that has TRIANGLE_STRIPS instead of triangles defined as POLYGONS.</p>
<p>EDIT: It looks like this is not a bug but the intended behavior of Model Maker:</p><aside class="onebox githubblob" data-onebox-src="https://github.com/Slicer/Slicer/blob/01984729eca68f0417ead58d87d3358912f094d4/Modules/CLI/ModelMaker/ModelMaker.cxx#L1550">
  <header class="source">

      <a href="https://github.com/Slicer/Slicer/blob/01984729eca68f0417ead58d87d3358912f094d4/Modules/CLI/ModelMaker/ModelMaker.cxx#L1550" target="_blank" rel="noopener nofollow ugc">github.com</a>
  </header>

  <article class="onebox-body">
    <h4><a href="https://github.com/Slicer/Slicer/blob/01984729eca68f0417ead58d87d3358912f094d4/Modules/CLI/ModelMaker/ModelMaker.cxx#L1550" target="_blank" rel="noopener nofollow ugc">Slicer/Slicer/blob/01984729eca68f0417ead58d87d3358912f094d4/Modules/CLI/ModelMaker/ModelMaker.cxx#L1550</a></h4>



    <pre class="onebox"><code class="lang-cxx">
      <ol class="start lines" start="1540" style="counter-reset: li-counter 1539 ;">
          <li>else</li>
          <li>  {</li>
          <li>  normals-&gt;ComputePointNormalsOff();</li>
          <li>  }</li>
          <li>normals-&gt;SetInputConnection(transformer-&gt;GetOutputPort());</li>
          <li>normals-&gt;SetFeatureAngle(60);</li>
          <li>normals-&gt;SetSplitting(SplitNormals);</li>
          <li></li>
          <li>normals-&gt;ReleaseDataFlagOn();</li>
          <li></li>
          <li class="selected">if (stripper)</li>
          <li>  {</li>
          <li>  stripper-&gt;SetInputData(nullptr);</li>
          <li>  stripper = nullptr;</li>
          <li>  }</li>
          <li>stripper = vtkSmartPointer&lt;vtkStripper&gt;::New();</li>
          <li>std::string            comment3 = "Strip " + labelName;</li>
          <li>vtkPluginFilterWatcher watchStripper(stripper,</li>
          <li>                                     comment3.c_str(),</li>
          <li>                                     CLPProcessInformation,</li>
          <li>                                     1.0 / numFilterSteps,</li>
      </ol>
    </code></pre>



  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

<p>Can someone please explain why Model Maker uses triangle strips instead of triangles/polygons?</p>

---

## Post #9 by @lassoan (2023-05-10 02:51 UTC)

<aside class="quote no-group" data-username="benzwick" data-post="8" data-topic="29282">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="https://sea2.discourse-cdn.com/flex002/user_avatar/discourse.slicer.org/benzwick/48/80521_2.png" class="avatar"> benzwick:</div>
<blockquote>
<p>Can someone please explain why Model Maker uses triangle strips instead of triangles/polygons?</p>
</blockquote>
</aside>
<p>Triangle strips are much more efficient to store and render than triangle meshes, as you only need to have one point for each triangle, while in a triangle mesh you need to specify 3 points for each triangle. STL file format is very limited - it does not support triangle strip representation, therefore we convert polygons, triangle strips, etc. to triangle mesh before writing to this format.</p>
<p>You can convert to/from triangle strip representation anytime using vtkStripper/vtkTriangleFilter.</p>

---

## Post #10 by @benzwick (2023-05-12 03:39 UTC)

<p>Thanks for the explanation <a class="mention" href="/u/lassoan">@lassoan</a>. I wasn’t aware of triangle strips. However, it seems that the Segmentations module uses triangles/polygons whereas Model Maker uses triangle strips. The “Uniform remesh” tool of the Surface Toolbox works if I create the model using the Segmentations module. If I use Model Maker, I need to first save to STL and reload, which converts the triangle strips to triangles/polygons. Otherwise, it fails with this error:</p>
<pre><code class="lang-plaintext">Failed to compute output model: Clean tolerance is too high. Empty mesh returned.
</code></pre>

---

## Post #11 by @lassoan (2023-05-12 03:53 UTC)

<p>Thanks for the additional information. It seems that all we need to do is run the model node’s polydata through a <code>vtkTriangleFilter</code> (3-4 lines of code). It would be great if you could add it and if it works well for you then make the change <a href="https://github.com/Slicer/SlicerSurfaceToolbox/blob/master/SurfaceToolbox/SurfaceToolbox.py#L409">here</a> and submit a pull request.</p>
<p>Triangle stripping was critically important when the model maker was developed 15-20 years ago because every bit of performance had to be squeezed out from the graphics hardware. Using techniques such as triangle stripping and backface culling nowadays rarely lead to noticeable rendering speed difference, that’s why we don’t use them much (and can even afford to enable by default computationally expensive techniques, such as depth peeling).</p>

---

## Post #12 by @benzwick (2023-05-12 04:20 UTC)

<p>What is the recommended way to develop and test a module that is already installed in Slicer? I cloned the SlicerSurfaceToolbox code and tried adding the SurfaceToolbox module in “Additional module paths” of settings, but still, the installed module is used.</p>

---

## Post #13 by @lassoan (2023-05-12 04:37 UTC)

<p>I would recommend to simply edit the .py files that you can find in the installed Slicer folder.</p>

---

## Post #14 by @benzwick (2023-05-12 05:01 UTC)

<p>I’ve created a pull request here: <a href="https://github.com/Slicer/SlicerSurfaceToolbox/pull/58" class="inline-onebox" rel="noopener nofollow ugc">ENH: Uniform remesh models with triangle strips by benzwick · Pull Request #58 · Slicer/SlicerSurfaceToolbox · GitHub</a></p>

---
