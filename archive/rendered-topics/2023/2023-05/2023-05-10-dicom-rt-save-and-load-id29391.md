# Dicom rt save and load

**Topic ID**: 29391
**Date**: 2023-05-10
**URL**: https://discourse.slicer.org/t/dicom-rt-save-and-load/29391

---

## Post #1 by @Dex2046 (2023-05-10 02:51 UTC)

<p>I segmented a PET image and exported the segmentation as rtstruct with dicom-rt format. But, when I import the rtstruct, something goes wrong. Where is the problem, thank you for all.<br>
<img src="https://us1.discourse-cdn.com/flex002/uploads/slicer/original/3X/d/6/d698cccd00aa65b8200939386a2d314d57641d52.png" alt="屏幕截图 2023-05-10 105103" data-base62-sha1="uCpyaHVTaMU5HvLiOlsi1idiLqa" width="447" height="352"></p>
<p><img src="https://us1.discourse-cdn.com/flex002/uploads/slicer/original/3X/6/0/60d834d7bc2d49b89226fc04641aae7cbab5f677.png" alt="屏幕截图 2023-05-10 104842" data-base62-sha1="dOJ3yacN0RfXVO5Csyvqxz1ATMH" width="591" height="401"><br>
<img src="https://us1.discourse-cdn.com/flex002/uploads/slicer/original/3X/0/8/083e453be8cb5c2d71e56d433a59b4bbd381ba27.png" alt="屏幕截图 2023-05-10 104912" data-base62-sha1="1aVetS4nN4ZvmbuXYOyUkhY43Q3" width="588" height="126"></p>

---

## Post #2 by @lassoan (2023-05-10 04:44 UTC)

<p>It may be just a visualization issue or an invalid RT structure set. If you create a binary labelmap representation and there are still artifacts then it means that the structure set is invalid. What software did you use to generate the structure set?</p>

---

## Post #3 by @Dex2046 (2023-05-10 05:18 UTC)

<p>the structure set was generated by 3d-slicer <img src="https://emoji.discourse-cdn.com/twitter/sweat_smile.png?v=12" title=":sweat_smile:" class="emoji" alt=":sweat_smile:" loading="lazy" width="20" height="20"></p>

---

## Post #4 by @lassoan (2023-05-10 05:25 UTC)

<p>RT structure sets are designed for storing manually drawn polygons. It is not suitable at all for general-purpose storage of any image segmentation result. SlicerRT uses Plastimatch library to try to convert binary labelmap segmentation to polygons, but of course it can only work for simple shapes.</p>
<p>If you want to save segmentation into DICOM I would recommend to use DICOM Segmentation Object (exporter is provided by QuantitativeReporting extension).</p>

---

## Post #5 by @Dex2046 (2023-05-10 05:37 UTC)

<p>You mean that I draw a too complex segmentation for dicom RT structure? I am just testing the possibility the export the segmentation to tps  because our tps do not support pet image.</p>
<p>I’ll test some simple rois, thank you.</p>

---

## Post #6 by @gcsharp (2023-05-10 12:57 UTC)

<p>You are showing a coronal plane.  Is the PET image oriented coronally?</p>
<p>Also, does the ROI have “donut-shaped” regions?  What I mean is an ROI with a hole somewhere in the middle.</p>

---

## Post #7 by @Dex2046 (2023-05-11 00:17 UTC)

<p>The roi was drawn with threshold tool, so I did get some holes.<br>
The orientation is corrected.</p>

---

## Post #8 by @gcsharp (2023-05-11 14:46 UTC)

<p>Can you try again with a ROI that doesn’t have holes?</p>
<p>Also, which TPS is this?</p>

---

## Post #9 by @Dex2046 (2023-05-12 04:31 UTC)

<p>I opened the rtstructure I saved using 3d-slicer.</p>
<p>I’ll try later, thank you</p>

---

## Post #10 by @Dex2046 (2023-05-15 00:55 UTC)

<p>I manually draw some a voi while a hole in the middle. When I loaded the rtstructure, the hole disappeared.</p>
<p>I open the segmentation editor, click a tool, then i got a message, like the picture, choose yes, then the hole came back.</p>
<p>I also tried the complex segmentation, unfortunately, 3d-slicer does not response.<br>
<img src="https://us1.discourse-cdn.com/flex002/uploads/slicer/original/3X/d/c/dcf769265327f0543bbeafa3c6211520182612c5.png" alt="屏幕截图 2023-05-15 085500" data-base62-sha1="vwL7lLMJT3lxLZUf8iNr3sX3usJ" width="535" height="240"></p>

---

## Post #11 by @lassoan (2023-05-17 18:34 UTC)

<p>When segmentation is displayed in 2D views using <code>Closed surface</code> representation (either because this is the only available representation or because this representation is chosen to be shown in <code>Segmentations</code> module: <code>Display</code> / <code>Advanced</code> / <code>Representation in 2D views</code> → <code>Closed surface</code>) then filling of the contours may be incomplete and/or inverted. To avoid this, create <code>Binary labelmap</code> representation and choose <code>Representation in 2D views</code> → <code>Binary labelmap</code></p>

---
