# Error exporting and importing .vtk

**Topic ID**: 30733
**Date**: 2023-07-21
**URL**: https://discourse.slicer.org/t/error-exporting-and-importing-vtk/30733

---

## Post #1 by @gches (2023-07-21 19:36 UTC)

<p>Hello,</p>
<p>I am trying to save the centerline of a model to .vtk. I receive no errors when exporting, however, when importing the centerline into 3D slicer, I receive an error.</p>
<p>I received this error on both Slicer versions 4.11 and 5.2.2</p>
<p>The workflow is as follows:</p>
<ol>
<li>Import the model that I want to find the centerline of (.vtk file format)</li>
<li>Use the extract centerline tool to obtain the centerline (using the network model output)</li>
<li>Export the centerline model as a .vtk file (unselected the compress option)</li>
<li>Importing that same centerline model back into the scene</li>
<li>An error is obtained and it failed to import</li>
</ol>
<p>The error is as follows</p>
<ul>
<li>Error: Loading bifurCenterline.vtk - ERROR: In D:\D\S\S-0-build\VTK\IO\Legacy\vtkDataReader.cxx, line 1974<br>
vtkPolyDataReader (0000028B8AE06190): Unsupported data type:</li>
<li>Error: Loading bifurCenterline.vtk - Failed to read node bifurCenterline_1 (vtkMRMLModelNode11) from filename=‘bifurCenterline.vtk’</li>
</ul>
<p>For reference, the bifurCenterline is the file name for the centerline .vtk file<br>
Thank you for any help.</p>

---

## Post #2 by @lassoan (2023-07-22 13:23 UTC)

<p>.vtk files can store either a mesh or an image. It is used for meshes more commonly. It is not suitable for storing medical images, because it cannot store the patient orientation (if you use this format then your images may be rotated after saving into and loading from this format).</p>
<p>If you have want to load an image from .vtk format anyway then in the “Add data” window, choose “Volume” in the “Description” column.</p>

---

## Post #3 by @gches (2023-07-22 17:42 UTC)

<p>I think the problem lies with slicer saving a corrupt or incorrectly formatted .vtk file for the centerline. I followed the steps from <a href="https://discourse.slicer.org/t/how-to-export-centerline-generated-by-the-vmtk/22735/3">this previous thread</a> , but when I go to reopen the saved centerline I received the error I pasted above. I also receive an error when opening it in other .vtk file viewers such as paraview.</p>
<p>I’d be more than happy to provide the files for the model and the centerline if there is a way to do that.</p>

---

## Post #4 by @lassoan (2023-07-23 15:10 UTC)

<p>Can you upload a problematic .vtk file somewhere and post the link here?</p>

---

## Post #5 by @gches (2023-07-23 17:57 UTC)

<p>I attached two files:</p>
<p>bifurModel.vtk: The .vtk file I am attempting to find the centerline of using the extract centerline module. I have no issue importing and exporting this file. Here is a <a href="https://drive.google.com/file/d/1wW0KGUpPNTCSyx9ot3NJAlwp1-hWBu9S/view?usp=sharing" rel="noopener nofollow ugc">google drive link</a>.</p>
<p>bifurModelCenterline.vtk: This is the centerline generated by the extract centerline module. I exported it in .vtk file format without compression. However, I am unable to import it back into 3D slicer or view it in any other .vtk file viewers. Here is a <a href="https://drive.google.com/file/d/1H0-S91PZqFuAD4RogRjiFjKbrqH1tJNq/view?usp=sharing" rel="noopener nofollow ugc">google drive link</a>.</p>

---

## Post #6 by @lassoan (2023-07-24 04:12 UTC)

<p>One of values in the <code>Torsion</code>  array contains an invalid value, which VTK saves as <code>-nan(ind)</code>. However, VTK cannot save and load such values in non-compressed (ASCII) .vtk file format. This is a bug in VTK and I’ve filed a bug report for you:</p>
<aside class="onebox allowlistedgeneric" data-onebox-src="https://gitlab.kitware.com/vtk/vtk/-/issues/19028">
  <header class="source">
      <img src="https://gitlab.kitware.com/uploads/-/system/appearance/favicon/1/KitwareMarkIcon.png" class="site-icon" width="32" height="32">

      <a href="https://gitlab.kitware.com/vtk/vtk/-/issues/19028" target="_blank" rel="noopener">GitLab</a>
  </header>

  <article class="onebox-body">
    <img src="https://gitlab.kitware.com/uploads/-/system/project/avatar/13/vtk_logo-main1.png" class="thumbnail onebox-avatar" width="146" height="146">

<h3><a href="https://gitlab.kitware.com/vtk/vtk/-/issues/19028" target="_blank" rel="noopener">Fail to load polydata from ASCII .vtk file if any array contain a nan value...</a></h3>

  <p>If there is an invalid value in any of the data arrays then the saved an ASCII .vtk file then VTK cannot read the file that it has...</p>


  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

<p>To avoid running into this issue, you can save the centerline as .vtp file or binary .vtk file, or export the centerline into markup node and save as JSON.</p>

---
