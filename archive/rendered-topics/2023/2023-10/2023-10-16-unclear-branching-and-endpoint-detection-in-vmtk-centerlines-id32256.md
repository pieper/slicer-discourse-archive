# Unclear branching and endpoint detection in vmtk-centerlines

**Topic ID**: 32256
**Date**: 2023-10-16
**URL**: https://discourse.slicer.org/t/unclear-branching-and-endpoint-detection-in-vmtk-centerlines/32256

---

## Post #1 by @b_gop (2023-10-16 16:18 UTC)

<p>Hi all,</p>
<p>I used the vmtk-centerlines module to auto-detect endpoints and then compute the centerline on my dataset. Using the centerline quantification data, I ran a script to add mark up points on each of the start and end position coordinates for centerline segments.</p>
<p>In the images attached below,<br>
YELLOW= auto detected end-points<br>
RED= Start position points<br>
GREEN= End position points.</p>
<p>I do not understand how:</p>
<ol>
<li>A major chunk of the structure has no centerline segments detected</li>
<li>The disparity between the auto detected endpoints and the centerline segment endpoints</li>
</ol>
<p>Could someone help me out with this?</p>
<p>Thank you!</p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="https://us1.discourse-cdn.com/flex002/uploads/slicer/original/3X/9/2/924529d9ed10dfdeec03c2dae93b694a541087ad.png" data-download-href="/uploads/short-url/kRXTlM1DpY3pkXiuYDEeIJCLHvT.png?dl=1" title="Screenshot_1" rel="noopener nofollow ugc"><img src="https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/9/2/924529d9ed10dfdeec03c2dae93b694a541087ad_2_690x447.png" alt="Screenshot_1" data-base62-sha1="kRXTlM1DpY3pkXiuYDEeIJCLHvT" width="690" height="447" srcset="https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/9/2/924529d9ed10dfdeec03c2dae93b694a541087ad_2_690x447.png, https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/9/2/924529d9ed10dfdeec03c2dae93b694a541087ad_2_1035x670.png 1.5x, https://us1.discourse-cdn.com/flex002/uploads/slicer/original/3X/9/2/924529d9ed10dfdeec03c2dae93b694a541087ad.png 2x" data-dominant-color="9D99B9"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">Screenshot_1</span><span class="informations">1141×740 247 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div><br>
<div class="lightbox-wrapper"><a class="lightbox" href="https://us1.discourse-cdn.com/flex002/uploads/slicer/original/3X/d/7/d7b033dbf1b82597846b6ea807eb4ef9c0bff23f.png" data-download-href="/uploads/short-url/uM4arpGTUCTaDqyFT1qoZNwXOlp.png?dl=1" title="Screenshot" rel="noopener nofollow ugc"><img src="https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/d/7/d7b033dbf1b82597846b6ea807eb4ef9c0bff23f_2_690x447.png" alt="Screenshot" data-base62-sha1="uM4arpGTUCTaDqyFT1qoZNwXOlp" width="690" height="447" srcset="https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/d/7/d7b033dbf1b82597846b6ea807eb4ef9c0bff23f_2_690x447.png, https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/d/7/d7b033dbf1b82597846b6ea807eb4ef9c0bff23f_2_1035x670.png 1.5x, https://us1.discourse-cdn.com/flex002/uploads/slicer/original/3X/d/7/d7b033dbf1b82597846b6ea807eb4ef9c0bff23f.png 2x" data-dominant-color="9E9BC4"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">Screenshot</span><span class="informations">1141×740 147 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div><br>
<div class="lightbox-wrapper"><a class="lightbox" href="https://us1.discourse-cdn.com/flex002/uploads/slicer/original/3X/2/e/2e4476ebe8dd8aefc6de8df5d3a7792fda6c2f9e.png" data-download-href="/uploads/short-url/6BiEbOzzBYfWng3YssaXBAZSD2C.png?dl=1" title="Screenshot_3 (1)" rel="noopener nofollow ugc"><img src="https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/2/e/2e4476ebe8dd8aefc6de8df5d3a7792fda6c2f9e_2_690x447.png" alt="Screenshot_3 (1)" data-base62-sha1="6BiEbOzzBYfWng3YssaXBAZSD2C" width="690" height="447" srcset="https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/2/e/2e4476ebe8dd8aefc6de8df5d3a7792fda6c2f9e_2_690x447.png, https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/2/e/2e4476ebe8dd8aefc6de8df5d3a7792fda6c2f9e_2_1035x670.png 1.5x, https://us1.discourse-cdn.com/flex002/uploads/slicer/original/3X/2/e/2e4476ebe8dd8aefc6de8df5d3a7792fda6c2f9e.png 2x" data-dominant-color="9A9EC6"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">Screenshot_3 (1)</span><span class="informations">1141×740 116 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div><br>
<div class="lightbox-wrapper"><a class="lightbox" href="https://us1.discourse-cdn.com/flex002/uploads/slicer/original/3X/7/a/7a4ed14b5b408938e8b85ab4d7ea3113dbcb0c1d.png" data-download-href="/uploads/short-url/hrZ7gDaKimtR9m9embjLJesYV5z.png?dl=1" title="Screenshot_2" rel="noopener nofollow ugc"><img src="https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/7/a/7a4ed14b5b408938e8b85ab4d7ea3113dbcb0c1d_2_690x447.png" alt="Screenshot_2" data-base62-sha1="hrZ7gDaKimtR9m9embjLJesYV5z" width="690" height="447" srcset="https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/7/a/7a4ed14b5b408938e8b85ab4d7ea3113dbcb0c1d_2_690x447.png, https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/7/a/7a4ed14b5b408938e8b85ab4d7ea3113dbcb0c1d_2_1035x670.png 1.5x, https://us1.discourse-cdn.com/flex002/uploads/slicer/original/3X/7/a/7a4ed14b5b408938e8b85ab4d7ea3113dbcb0c1d.png 2x" data-dominant-color="9F9BC5"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">Screenshot_2</span><span class="informations">1141×740 127 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>

---

## Post #2 by @lassoan (2023-10-17 01:45 UTC)

<p>Network extraction algorithm computes simple geometric centerline. It can be used for any geometry.</p>
<p>Centerline extraction algorithm is for extracting a tree (or forest) topology from a graph. It computes the path on a Voronoi diagram according to flow direction. Centerline extraction method tends to require a bit larger diameter tubes (otherwise it fails to find a connecting path on the Voronoi diagram).</p>
<p>I would recommend reading <a href="http://lantiga.github.io/media/AntigaPhDThesis.pdf">Luca’s thesis</a> for details.</p>

---

## Post #3 by @smoudour (2023-10-18 10:36 UTC)

<p>Does my case fall into the “not large enough diameter cubes” ? I’m trying to construct correct centerlines for coronary arteries.<br>
Errors in my case:<br>
<div class="lightbox-wrapper"><a class="lightbox" href="https://us1.discourse-cdn.com/flex002/uploads/slicer/original/3X/8/e/8e779597763c325abba92b2e8a0bfb10407e1ab9.png" data-download-href="/uploads/short-url/kkk0ySZlc913QJJNEdjyiQhBiv7.png?dl=1" title="centerlines_1" rel="noopener nofollow ugc"><img src="https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/8/e/8e779597763c325abba92b2e8a0bfb10407e1ab9_2_633x500.png" alt="centerlines_1" data-base62-sha1="kkk0ySZlc913QJJNEdjyiQhBiv7" width="633" height="500" srcset="https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/8/e/8e779597763c325abba92b2e8a0bfb10407e1ab9_2_633x500.png, https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/8/e/8e779597763c325abba92b2e8a0bfb10407e1ab9_2_949x750.png 1.5x, https://us1.discourse-cdn.com/flex002/uploads/slicer/original/3X/8/e/8e779597763c325abba92b2e8a0bfb10407e1ab9.png 2x" data-dominant-color="9D9ECD"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">centerlines_1</span><span class="informations">986×778 169 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="https://us1.discourse-cdn.com/flex002/uploads/slicer/original/3X/8/e/8e779597763c325abba92b2e8a0bfb10407e1ab9.png" data-download-href="/uploads/short-url/kkk0ySZlc913QJJNEdjyiQhBiv7.png?dl=1" title="centerlines_1" rel="noopener nofollow ugc"><img src="https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/8/e/8e779597763c325abba92b2e8a0bfb10407e1ab9_2_633x500.png" alt="centerlines_1" data-base62-sha1="kkk0ySZlc913QJJNEdjyiQhBiv7" width="633" height="500" srcset="https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/8/e/8e779597763c325abba92b2e8a0bfb10407e1ab9_2_633x500.png, https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/8/e/8e779597763c325abba92b2e8a0bfb10407e1ab9_2_949x750.png 1.5x, https://us1.discourse-cdn.com/flex002/uploads/slicer/original/3X/8/e/8e779597763c325abba92b2e8a0bfb10407e1ab9.png 2x" data-dominant-color="9D9ECD"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">centerlines_1</span><span class="informations">986×778 169 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div><br>
–First image shows weird straight lines while origin points are inside voronoi.<br>
–Second image shows that whole tree <strong>does not</strong> get extracted for some reason. Also, the centerline model is incomplete and does not cover the centerline curves produced.</p>
<p>On the contrary, network extraction is (almost) flawless:<br>
<div class="lightbox-wrapper"><a class="lightbox" href="https://us1.discourse-cdn.com/flex002/uploads/slicer/original/3X/a/f/af61fe105f2f1c361c29da3b34b2de17e63f2c2e.jpeg" data-download-href="/uploads/short-url/p1vvjP7pJFI5ts9bj5OYONwBe7c.jpeg?dl=1" title="network_ok" rel="noopener nofollow ugc"><img src="https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/a/f/af61fe105f2f1c361c29da3b34b2de17e63f2c2e_2_690x470.jpeg" alt="network_ok" data-base62-sha1="p1vvjP7pJFI5ts9bj5OYONwBe7c" width="690" height="470" srcset="https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/a/f/af61fe105f2f1c361c29da3b34b2de17e63f2c2e_2_690x470.jpeg, https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/a/f/af61fe105f2f1c361c29da3b34b2de17e63f2c2e_2_1035x705.jpeg 1.5x, https://us1.discourse-cdn.com/flex002/uploads/slicer/original/3X/a/f/af61fe105f2f1c361c29da3b34b2de17e63f2c2e.jpeg 2x" data-dominant-color="9B9CCB"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">network_ok</span><span class="informations">1294×883 117 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<p>I have two questions:</p>
<ul>
<li>What exactly is the difference between <strong>network</strong> and <strong>centerline</strong> models?</li>
<li>How exactly does endpoint placement works in these two cases? Because for network extraction I only need to place a point in the origin of my structure, while in centerline extraction I cannot figure out how to place them. Also, why centerline model does not cover exact same path as centerline curves?</li>
</ul>

---
