# Centerline computation problem - straight lines

**Topic ID**: 32397
**Date**: 2023-10-24
**URL**: https://discourse.slicer.org/t/centerline-computation-problem-straight-lines/32397

---

## Post #1 by @smoudour (2023-10-24 14:39 UTC)

<p>Hi all.</p>
<p>I have been working with 3D slicer for a few months now. I am trying to isolate coronary arteries from CCTA scans, get the centerlines and quantify some geometric features I need for further analysis.</p>
<p>As far, I have managed to get some adequate segmentations of the coronaries and succesful <strong>network model - curves - properties</strong>. What I cannot seem to get is accurate <strong>centerlines</strong>. Specifically, while I get an (almost) correct centerline model, the centerline curves constructed are not good. I’m attaching an image for reference. Could someone explain why do I get this result? I have messed with the endpoints (both manually placed and auto detected) and I always get these weird straight lines. When computing the centerline curves, I get this warning:</p>
<p><code>[VTK] Warning: In vtkDelaunay3D.cxx, line 526</code><br>
<code>[VTK] vtkDelaunay3D (00000236E6A111E0): 1 degenerate triangles encountered, mesh quality suspect</code></p>
<p>Here is an image of the constructed centerline <strong>tree</strong>:<br>
<div class="lightbox-wrapper"><a class="lightbox" href="https://us1.discourse-cdn.com/flex002/uploads/slicer/original/3X/7/c/7c39882295d564516141ac30ce69628ca56c0df2.jpeg" data-download-href="/uploads/short-url/hIWsZspoj8fPGG50rna2WMMMiYy.jpeg?dl=1" title="centerline_problem" rel="noopener nofollow ugc"><img src="https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/7/c/7c39882295d564516141ac30ce69628ca56c0df2_2_517x316.jpeg" alt="centerline_problem" data-base62-sha1="hIWsZspoj8fPGG50rna2WMMMiYy" width="517" height="316" srcset="https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/7/c/7c39882295d564516141ac30ce69628ca56c0df2_2_517x316.jpeg, https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/7/c/7c39882295d564516141ac30ce69628ca56c0df2_2_775x474.jpeg 1.5x, https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/7/c/7c39882295d564516141ac30ce69628ca56c0df2_2_1034x632.jpeg 2x" data-dominant-color="9A9BCC"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">centerline_problem</span><span class="informations">1335×817 115 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<p>As a reference, the <strong>centerline model</strong> is pretty accurate:<br>
<div class="lightbox-wrapper"><a class="lightbox" href="https://us1.discourse-cdn.com/flex002/uploads/slicer/original/3X/d/c/dc0c5f93ad9b9f81c8810be9803c4e83b3b77a6b.png" data-download-href="/uploads/short-url/voDyiMos0T6hYTkDesNeNaZjkkb.png?dl=1" title="centerline_model_OK" rel="noopener nofollow ugc"><img src="https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/d/c/dc0c5f93ad9b9f81c8810be9803c4e83b3b77a6b_2_354x375.png" alt="centerline_model_OK" data-base62-sha1="voDyiMos0T6hYTkDesNeNaZjkkb" width="354" height="375" srcset="https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/d/c/dc0c5f93ad9b9f81c8810be9803c4e83b3b77a6b_2_354x375.png, https://us1.discourse-cdn.com/flex002/uploads/slicer/original/3X/d/c/dc0c5f93ad9b9f81c8810be9803c4e83b3b77a6b.png 1.5x, https://us1.discourse-cdn.com/flex002/uploads/slicer/original/3X/d/c/dc0c5f93ad9b9f81c8810be9803c4e83b3b77a6b.png 2x" data-dominant-color="9DA0CD"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">centerline_model_OK</span><span class="informations">498×526 47.1 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<p>I’m trying to get the centerline tree geometry quantification because I want to compute angles of bifurcations along other features, and after some research I found out it is better suited for this task (<em>reference post</em> : <a href="https://discourse.slicer.org/t/separating-centerline-metrics/19173" class="inline-onebox">Separating centerline metrics</a> ).</p>
<p>My questions are:</p>
<ul>
<li>why do I get these weird straight lines. How can I access this “mesh quality” error? How can I fix it?</li>
<li>what is the correct way to place the endpoints if there is some preffered manned that is.</li>
<li>Does it matter that in the same segmentation also lives the Right Coronary Artery?<br>
<div class="lightbox-wrapper"><a class="lightbox" href="https://us1.discourse-cdn.com/flex002/uploads/slicer/original/3X/8/d/8d5915f12468a9b2e0b1f4fb49281545e70bd707.png" data-download-href="/uploads/short-url/kaqbGVTQDiVHrI2TwUQXOq6QR2T.png?dl=1" title="total" rel="noopener nofollow ugc"><img src="https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/8/d/8d5915f12468a9b2e0b1f4fb49281545e70bd707_2_341x250.png" alt="total" data-base62-sha1="kaqbGVTQDiVHrI2TwUQXOq6QR2T" width="341" height="250" srcset="https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/8/d/8d5915f12468a9b2e0b1f4fb49281545e70bd707_2_341x250.png, https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/8/d/8d5915f12468a9b2e0b1f4fb49281545e70bd707_2_511x375.png 1.5x, https://us1.discourse-cdn.com/flex002/uploads/slicer/optimized/3X/8/d/8d5915f12468a9b2e0b1f4fb49281545e70bd707_2_682x500.png 2x" data-dominant-color="9B9DCD"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">total</span><span class="informations">1082×793 104 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></li>
</ul>

---
